diff --git a/CMakeLists.txt b/CMakeLists.txt
index f4ad148..34f0220 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -2,16 +2,17 @@
 #  duneprototypes main build file
 # ======================================================================
 
-cmake_minimum_required (VERSION 3.19 FATAL_ERROR)
+cmake_minimum_required (VERSION 3.20 FATAL_ERROR) ### MIGRATE-CHANGED (migrate-3.22.02) - VERSION 3.19 -> 3.20
+# cmake_policy(VERSION 3.19) ### MIGRATE-ACTION-COMPATIBILITY (migrate-3.22.02) - Uncomment to preserve compatibility with older CMake versions
 
-project(duneprototypes LANGUAGES CXX)
+find_package(cetmodules REQUIRED) ### MIGRATE-ADDED (migrate-3.22.02) - find_package(cetmodules) must precede project()
+project(duneprototypes LANGUAGES CXX) ### MIGRATE-CHANGED (migrate-3.22.02) - VERSION -> set(CMAKE_PROJECT_VERSION_STRING ...)
 set(${PROJECT_NAME}_CMAKE_PROJECT_VERSION_STRING 09.81.00d00)
-
+set(${PROJECT_NAME}_FW_DIR "config_data")
 # cetbuildtools contains our cmake modules
-find_package(cetbuildtools REQUIRED)
 
-list(APPEND CMAKE_MODULE_PATH $ENV{CANVAS_ROOT_IO_DIR}/Modules)
-list(APPEND CMAKE_MODULE_PATH $ENV{ART_DIR}/Modules)
+list(APPEND CMAKE_MODULE_PATH $ENV{CANVAS_ROOT_IO_DIR}/Modules) ### MIGRATE-ACTION-RECOMMENDED (migrate-3.22.02) - prefer find_package() to find external CMake modules
+list(APPEND CMAKE_MODULE_PATH $ENV{ART_DIR}/Modules) ### MIGRATE-ACTION-RECOMMENDED (migrate-3.22.02) - prefer find_package() to find external CMake modules
 
 
 include(CetCMakeEnv)
@@ -24,51 +25,49 @@ cet_set_compiler_flags(DIAGS CAUTIOUS
               -Wno-unused-result
 )
 
-cet_report_compiler_flags()
+cet_report_compiler_flags() ### MIGRATE-ACTION-RECOMMENDED (migrate-3.22.02) - add args: REPORT_THRESHOLD VERBOSE
 
-find_ups_boost( )
-find_ups_product( art )
-find_ups_product( art_root_io )
-find_ups_product( canvas_root_io )
-find_ups_root()
-find_ups_product( cetbuildtools )
-find_ups_product( larcore )
-find_ups_product( larcorealg )
-find_ups_product( larcoreobj )
-find_ups_product( larpandora )
-find_ups_product( dunecore )
-find_ups_product( lardataobj )
-find_ups_product( lardataalg )
-find_ups_product( lardata )
-find_ups_product( larevt )
-find_ups_product( larsim )
-find_ups_product( duneopdet )
-find_ups_product( dunecalib )
-find_ups_product( dunesim )
-find_ups_product( nusimdata )
-find_ups_product( nug4 )
-find_ups_product( dunepdlegacy )
-find_ups_product( artdaq_core )
-find_ups_product( TRACE )
-find_ups_product( clhep )
-find_ups_product( dunedaqdataformats )
-find_ups_product( dunedetdataformats )
-find_ups_product( postgresql )
-find_ups_product( libwda )
-find_ups_product( ifdh_art )
-find_ups_product( ifdhc )
-find_ups_product( ifbeam )
-find_ups_geant4( )
-find_ups_product( nlohmann_json )
-find_ups_product( highfive )
+find_package( Boost REQUIRED ) ### MIGRATE-CHANGED (migrate-3.22.02) - find_ups_product(...) -> find_package(REQUIRED ...)
+find_package( art REQUIRED ) ### MIGRATE-CHANGED (migrate-3.22.02) - find_ups_product(art ...) -> find_package(art REQUIRED ...)
+find_package( art_root_io REQUIRED ) ### MIGRATE-CHANGED (migrate-3.22.02) - find_ups_product(art_root_io ...) -> find_package(art_root_io REQUIRED ...)
+find_package( canvas_root_io REQUIRED ) ### MIGRATE-CHANGED (migrate-3.22.02) - find_ups_product(canvas_root_io ...) -> find_package(canvas_root_io REQUIRED ...)
+find_package(ROOT REQUIRED) ### MIGRATE-CHANGED (migrate-3.22.02) - find_ups_product(...) -> find_package(REQUIRED ...)
+find_package( larcore REQUIRED ) ### MIGRATE-CHANGED (migrate-3.22.02) - find_ups_product(larcore ...) -> find_package(larcore REQUIRED ...)
+find_package( larcorealg REQUIRED ) ### MIGRATE-CHANGED (migrate-3.22.02) - find_ups_product(larcorealg ...) -> find_package(larcorealg REQUIRED ...)
+find_package( larcoreobj REQUIRED ) ### MIGRATE-CHANGED (migrate-3.22.02) - find_ups_product(larcoreobj ...) -> find_package(larcoreobj REQUIRED ...)
+find_package( larpandora REQUIRED ) ### MIGRATE-CHANGED (migrate-3.22.02) - find_ups_product(larpandora ...) -> find_package(larpandora REQUIRED ...)
+find_package( dunecore REQUIRED ) ### MIGRATE-CHANGED (migrate-3.22.02) - find_ups_product(dunecore ...) -> find_package(dunecore REQUIRED ...)
+find_package( lardataobj REQUIRED ) ### MIGRATE-CHANGED (migrate-3.22.02) - find_ups_product(lardataobj ...) -> find_package(lardataobj REQUIRED ...)
+find_package( lardataalg REQUIRED ) ### MIGRATE-CHANGED (migrate-3.22.02) - find_ups_product(lardataalg ...) -> find_package(lardataalg REQUIRED ...)
+find_package( lardata REQUIRED ) ### MIGRATE-CHANGED (migrate-3.22.02) - find_ups_product(lardata ...) -> find_package(lardata REQUIRED ...)
+find_package( larevt REQUIRED ) ### MIGRATE-CHANGED (migrate-3.22.02) - find_ups_product(larevt ...) -> find_package(larevt REQUIRED ...)
+find_package( larsim REQUIRED ) ### MIGRATE-CHANGED (migrate-3.22.02) - find_ups_product(larsim ...) -> find_package(larsim REQUIRED ...)
+find_package( duneopdet REQUIRED ) ### MIGRATE-CHANGED (migrate-3.22.02) - find_ups_product(duneopdet ...) -> find_package(duneopdet REQUIRED ...)
+find_package( dunecalib REQUIRED ) ### MIGRATE-CHANGED (migrate-3.22.02) - find_ups_product(dunecalib ...) -> find_package(dunecalib REQUIRED ...)
+find_package( dunesim REQUIRED ) ### MIGRATE-CHANGED (migrate-3.22.02) - find_ups_product(dunesim ...) -> find_package(dunesim REQUIRED ...)
+find_package( nusimdata REQUIRED ) ### MIGRATE-CHANGED (migrate-3.22.02) - find_ups_product(nusimdata ...) -> find_package(nusimdata REQUIRED ...)
+find_package( nug4 REQUIRED ) ### MIGRATE-CHANGED (migrate-3.22.02) - find_ups_product(nug4 ...) -> find_package(nug4 REQUIRED ...)
+find_package( dunepdlegacy REQUIRED ) ### MIGRATE-CHANGED (migrate-3.22.02) - find_ups_product(dunepdlegacy ...) -> find_package(dunepdlegacy REQUIRED ...)
+find_package( artdaq_core REQUIRED ) ### MIGRATE-CHANGED (migrate-3.22.02) - find_ups_product(artdaq_core ...) -> find_package(artdaq_core REQUIRED ...)
+find_package( TRACE REQUIRED ) ### MIGRATE-CHANGED (migrate-3.22.02) - find_ups_product(TRACE ...) -> find_package(TRACE REQUIRED ...)
+find_package( CLHEP REQUIRED ) ### MIGRATE-CHANGED (migrate-3.22.02) - find_ups_product(clhep ...) -> find_package(clhep REQUIRED ...)
+find_package( dunedaqdataformats REQUIRED ) ### MIGRATE-CHANGED (migrate-3.22.02) - find_ups_product(dunedaqdataformats ...) -> find_package(dunedaqdataformats REQUIRED ...)
+find_package( dunedetdataformats REQUIRED ) ### MIGRATE-CHANGED (migrate-3.22.02) - find_ups_product(dunedetdataformats ...) -> find_package(dunedetdataformats REQUIRED ...)
+find_package( PostgreSQL REQUIRED ) ### MIGRATE-CHANGED (migrate-3.22.02) - find_ups_product(postgresql ...) -> find_package(postgresql REQUIRED ...)
+find_package( libwda REQUIRED ) ### MIGRATE-CHANGED (migrate-3.22.02) - find_ups_product(libwda ...) -> find_package(libwda REQUIRED ...)
+find_package( ifdh_art REQUIRED ) ### MIGRATE-CHANGED (migrate-3.22.02) - find_ups_product(ifdh_art ...) -> find_package(ifdh_art REQUIRED ...)
+find_package( ifdhc REQUIRED ) ### MIGRATE-CHANGED (migrate-3.22.02) - find_ups_product(ifdhc ...) -> find_package(ifdhc REQUIRED ...)
+find_package( ifbeam REQUIRED ) ### MIGRATE-CHANGED (migrate-3.22.02) - find_ups_product(ifbeam ...) -> find_package(ifbeam REQUIRED ...)
+find_package( Geant4 REQUIRED ) ### MIGRATE-CHANGED (migrate-3.22.02) - find_ups_product(...) -> find_package(REQUIRED ...)
+find_package( nlohmann_json REQUIRED ) ### MIGRATE-CHANGED (migrate-3.22.02) - find_ups_product(nlohmann_json ...) -> find_package(nlohmann_json REQUIRED ...)
+#find_package( highfive REQUIRED ) ### MIGRATE-CHANGED (migrate-3.22.02) - find_ups_product(highfive ...) -> find_package(highfive REQUIRED ...)
 find_package( HDF5 REQUIRED EXPORT )
-
+find_package( nuevdb REQUIRED )
 # macros for artdaq_dictionary and simple_plugin
 include(ArtDictionary)
 include(ArtMake)
 include(BuildPlugins)
 
 add_subdirectory(duneprototypes)
-add_subdirectory(ups)
 
-include(UseCPack)
+cet_cmake_config() ### MIGRATE-ADDED (migrate-3.22.02) - required cmd
diff --git a/CMakePresets.json b/CMakePresets.json
new file mode 100644
index 0000000..b32fb80
--- /dev/null
+++ b/CMakePresets.json
@@ -0,0 +1,120 @@
+{
+   "configurePresets" : [
+      {
+         "cacheVariables" : {
+            "CMAKE_BUILD_TYPE" : {
+               "type" : "STRING",
+               "value" : "RelWithDebInfo"
+            },
+            "CMAKE_CXX_EXTENSIONS" : {
+               "type" : "BOOL",
+               "value" : "OFF"
+            },
+            "CMAKE_CXX_STANDARD_REQUIRED" : {
+               "type" : "BOOL",
+               "value" : "ON"
+            },
+            "duneprototypes_ADD_NOARCH_DIRS_INIT" : {
+               "type" : "INTERNAL",
+               "value" : "FW_DIR"
+            },
+            "duneprototypes_FW_DIR_INIT" : {
+               "type" : "STRING",
+               "value" : "config_data"
+            }
+         },
+         "description" : "Configuration settings translated from ups/product_deps",
+         "displayName" : "Configuration from product_deps",
+         "hidden" : true,
+         "name" : "from_product_deps"
+      },
+      {
+         "cacheVariables" : {
+            "CMAKE_CXX_COMPILER" : {
+               "type" : "STRING",
+               "value" : "$env{CETPKG_CXX_COMPILER}"
+            },
+            "CMAKE_CXX_STANDARD" : {
+               "type" : "STRING",
+               "value" : "$env{CETPKG_CXX_STANDARD}"
+            },
+            "CMAKE_C_COMPILER" : {
+               "type" : "STRING",
+               "value" : "$env{CETPKG_C_COMPILER}"
+            },
+            "CMAKE_Fortran_COMPILER" : {
+               "type" : "STRING",
+               "value" : "$env{CETPKG_Fortran_COMPILER}"
+            },
+            "UPS_CXX_COMPILER_ID" : {
+               "type" : "STRING",
+               "value" : "$env{CETPKG_CXX_COMPILER_ID}"
+            },
+            "UPS_CXX_COMPILER_VERSION" : {
+               "type" : "STRING",
+               "value" : "$env{CETPKG_CXX_COMPILER_VERSION}"
+            },
+            "UPS_C_COMPILER_ID" : {
+               "type" : "STRING",
+               "value" : "$env{CETPKG_C_COMPILER_ID}"
+            },
+            "UPS_C_COMPILER_VERSION" : {
+               "type" : "STRING",
+               "value" : "$env{CETPKG_C_COMPILER_VERSION}"
+            },
+            "UPS_Fortran_COMPILER_ID" : {
+               "type" : "STRING",
+               "value" : "$env{CETPKG_Fortran_COMPILER_ID}"
+            },
+            "UPS_Fortran_COMPILER_VERSION" : {
+               "type" : "STRING",
+               "value" : "$env{CETPKG_Fortran_COMPILER_VERSION}"
+            },
+            "WANT_UPS" : {
+               "type" : "BOOL",
+               "value" : true
+            },
+            "duneprototypes_EXEC_PREFIX_INIT" : {
+               "type" : "STRING",
+               "value" : "$env{CETPKG_FQ_DIR}"
+            },
+            "duneprototypes_UPS_BUILD_ONLY_DEPENDENCIES_INIT" : {
+               "type" : "STRING",
+               "value" : "cetmodules"
+            },
+            "duneprototypes_UPS_PRODUCT_FLAVOR_INIT" : {
+               "type" : "STRING",
+               "value" : "$env{CETPKG_FLAVOR}"
+            },
+            "duneprototypes_UPS_PRODUCT_NAME_INIT" : {
+               "type" : "STRING",
+               "value" : "duneprototypes"
+            },
+            "duneprototypes_UPS_QUALIFIER_STRING_INIT" : {
+               "type" : "STRING",
+               "value" : "$env{CETPKG_QUALSPEC}"
+            }
+         },
+         "description" : "Extra configuration for UPS package generation",
+         "displayName" : "UPS extra configuration",
+         "hidden" : true,
+         "name" : "extra_for_UPS"
+      },
+      {
+         "description" : "Default configuration including settings from ups/product_deps",
+         "displayName" : "Default configuration",
+         "inherits" : "from_product_deps",
+         "name" : "default"
+      },
+      {
+         "description" : "Default configuration for UPS package generation",
+         "displayName" : "Default configuration for UPS",
+         "inherits" : [
+            "default",
+            "extra_for_UPS"
+         ],
+         "name" : "for_UPS"
+      }
+   ],
+   "version" : 3
+}
diff --git a/duneprototypes/3x1x1dp/DataImport/ImportFullFile/CMakeLists.txt b/duneprototypes/3x1x1dp/DataImport/ImportFullFile/CMakeLists.txt
index 02788e3..664cbc2 100644
--- a/duneprototypes/3x1x1dp/DataImport/ImportFullFile/CMakeLists.txt
+++ b/duneprototypes/3x1x1dp/DataImport/ImportFullFile/CMakeLists.txt
@@ -3,17 +3,15 @@ cet_build_plugin(ImportFull311File art::source
 
 			lardataobj_RawData
 			lardata_Utilities
-			ART_FRAMEWORK_CORE
-			ART_FRAMEWORK_IO_SOURCES
-			ART_FRAMEWORK_PRINCIPAL
+			art::Framework_Core
+			art::Framework_IO_Sources
+			art::Framework_Principal
  			art::Persistency_Common canvas
 			art::Persistency_Provenance canvas
 			art::Utilities canvas
 			fhiclcpp::fhiclcpp
 			messagefacility::MF_MessageLogger
-			
-			CETLIB
-			ROOT_BASIC_LIB_LIST
+			ROOT::Core ROOT::Hist ROOT::Tree
 			BASENAME_ONLY
 )
 
diff --git a/duneprototypes/3x1x1dp/DataImport/ImportSingleEvent/CMakeLists.txt b/duneprototypes/3x1x1dp/DataImport/ImportSingleEvent/CMakeLists.txt
index 25952f5..50a63ff 100644
--- a/duneprototypes/3x1x1dp/DataImport/ImportSingleEvent/CMakeLists.txt
+++ b/duneprototypes/3x1x1dp/DataImport/ImportSingleEvent/CMakeLists.txt
@@ -12,19 +12,17 @@ cet_build_plugin(ImportSingle311Event art::module
 			larsim_Simulation nug4::ParticleNavigation lardataobj_Simulation
 			
 			nusimdata::SimulationBase
-			ART_FRAMEWORK_CORE
-			ART_FRAMEWORK_PRINCIPAL
-			ART_FRAMEWORK_SERVICES_REGISTRY
-			ART_ROOT_IO_TFILE_SUPPORT
+			art::Framework_Core
+			art::Framework_Principal
+			art::Framework_Services_Registry
+			art_root_io::tfile_support
 			ROOT::Core
-			ART_ROOT_IO_TFILESERVICE_SERVICE
+			art_root_io::TFileService_service
  			art::Persistency_Common canvas
 			art::Persistency_Provenance canvas
 			art::Utilities canvas
 			messagefacility::MF_MessageLogger
-			
-			CETLIB
-			ROOT_BASIC_LIB_LIST
+			ROOT::Core ROOT::Hist ROOT::Tree
 			BASENAME_ONLY
 )
 
diff --git a/duneprototypes/3x1x1dp/DataImport/Services/CMakeLists.txt b/duneprototypes/3x1x1dp/DataImport/Services/CMakeLists.txt
index a125689..9acebd5 100644
--- a/duneprototypes/3x1x1dp/DataImport/Services/CMakeLists.txt
+++ b/duneprototypes/3x1x1dp/DataImport/Services/CMakeLists.txt
@@ -5,16 +5,16 @@ cet_build_plugin(RawData311InputDriver art::service
 			lardataobj_RawData
 			lardata_Utilities
 			larcorealg_Geometry
-			ART_FRAMEWORK_CORE
-			ART_FRAMEWORK_IO_SOURCES
-			ART_FRAMEWORK_PRINCIPAL
+			art::Framework_Core
+		        art::Framework_IO_Sources	
+			art::Framework_Principal
  			art::Persistency_Common canvas
 			art::Persistency_Provenance canvas
 			art::Utilities canvas
 			messagefacility::MF_MessageLogger
 			
-			CETLIB
-			ROOT_BASIC_LIB_LIST
+			cetlib::cetlib
+			ROOT::Core ROOT::Hist ROOT::Tree
 			BASENAME_ONLY
 )
 
@@ -28,21 +28,22 @@ cet_build_plugin(dlardaq art::service
 			larcore_Geometry_Geometry_service
 			lardata_Utilities
 			larsim_Simulation nug4::ParticleNavigation lardataobj_Simulation
+		        art::Framework_IO_Sources	
 			
 			nusimdata::SimulationBase
-			ART_FRAMEWORK_CORE
-			ART_FRAMEWORK_PRINCIPAL
-			ART_FRAMEWORK_SERVICES_REGISTRY
-			ART_ROOT_IO_TFILE_SUPPORT
+			art::Framework_Core
+			art::Framework_Principal
+			art::Framework_Services_Registry
+			art_root_io::tfile_support
 			ROOT::Core
-			ART_ROOT_IO_TFILESERVICE_SERVICE
+			
  			art::Persistency_Common canvas
 			art::Persistency_Provenance canvas
 			art::Utilities canvas
 			messagefacility::MF_MessageLogger
 			
-			CETLIB
-			ROOT_BASIC_LIB_LIST
+			cetlib::cetlib
+			ROOT::Core ROOT::Hist ROOT::Tree
 			BASENAME_ONLY
 )
 
@@ -62,19 +63,20 @@ cet_build_plugin(EventDecoder art::service
 			larsim_Simulation nug4::ParticleNavigation lardataobj_Simulation
 			
 			nusimdata::SimulationBase
-			ART_FRAMEWORK_CORE
-			ART_FRAMEWORK_PRINCIPAL
-			ART_FRAMEWORK_SERVICES_REGISTRY
-			ART_ROOT_IO_TFILE_SUPPORT
+			art::Framework_Core
+			art::Framework_Principal
+			art::Framework_Services_Registry
+			art_root_io::tfile_support
 			ROOT::Core
-			ART_ROOT_IO_TFILESERVICE_SERVICE
+			
+		        art::Framework_IO_Sources	
  			art::Persistency_Common canvas
 			art::Persistency_Provenance canvas
 			art::Utilities canvas
 			messagefacility::MF_MessageLogger
 			
-			CETLIB
-			ROOT_BASIC_LIB_LIST
+			cetlib::cetlib
+			ROOT::Core ROOT::Hist ROOT::Tree
 			BASENAME_ONLY
 )
 
@@ -93,19 +95,20 @@ cet_build_plugin(HuffDataCompressor art::service
 			larsim_Simulation nug4::ParticleNavigation lardataobj_Simulation
 			
 			nusimdata::SimulationBase
-			ART_FRAMEWORK_CORE
-			ART_FRAMEWORK_PRINCIPAL
-			ART_FRAMEWORK_SERVICES_REGISTRY
-			ART_ROOT_IO_TFILE_SUPPORT
+			art::Framework_Core
+			art::Framework_Principal
+			art::Framework_Services_Registry
+			art_root_io::tfile_support
 			ROOT::Core
-			ART_ROOT_IO_TFILESERVICE_SERVICE
+			
  			art::Persistency_Common canvas
 			art::Persistency_Provenance canvas
 			art::Utilities canvas
 			messagefacility::MF_MessageLogger
 			
-			CETLIB
-			ROOT_BASIC_LIB_LIST
+		        art::Framework_IO_Sources	
+			cetlib::cetlib
+			ROOT::Core ROOT::Hist ROOT::Tree
 			BASENAME_ONLY
 )
 
diff --git a/duneprototypes/BeamData/CMakeLists.txt b/duneprototypes/BeamData/CMakeLists.txt
index 6da3913..9f01dd0 100644
--- a/duneprototypes/BeamData/CMakeLists.txt
+++ b/duneprototypes/BeamData/CMakeLists.txt
@@ -5,14 +5,15 @@ art_make_library(  LIBRARY_NAME  BeamData
 		             SOURCE ${src_files}
 			     LIBRARIES			
 	                wda::wda
+			ifdh::ifdh
 			ifbeam::ifbeam
 #			IFBeam_service
-                        ART_FRAMEWORK_CORE
-			ART_FRAMEWORK_PRINCIPAL
-			ART_FRAMEWORK_SERVICES_REGISTRY
-                        ART_ROOT_IO_TFILE_SUPPORT
+                        art::Framework_Core
+			art::Framework_Principal
+			art::Framework_Services_Registry
+                        art_root_io::tfile_support
                         ROOT::Core
-                        ART_ROOT_IO_TFILESERVICE_SERVICE
+                        
  			art::Persistency_Common canvas
 			art::Persistency_Provenance canvas
 			art::Utilities canvas
@@ -20,7 +21,7 @@ art_make_library(  LIBRARY_NAME  BeamData
                         
                         cetlib::cetlib cetlib_except
 			fhiclcpp::fhiclcpp
-                        ROOT_BASIC_LIB_LIST
+                        ROOT::Core ROOT::Hist ROOT::Tree
 			
         )
 
diff --git a/duneprototypes/BeamData/ProtoDUNEBeamSpill/CMakeLists.txt b/duneprototypes/BeamData/ProtoDUNEBeamSpill/CMakeLists.txt
index 15ff0c4..cb668fd 100644
--- a/duneprototypes/BeamData/ProtoDUNEBeamSpill/CMakeLists.txt
+++ b/duneprototypes/BeamData/ProtoDUNEBeamSpill/CMakeLists.txt
@@ -4,6 +4,6 @@ art_make(
 #     ${ROOT_GENVECTOR} #LorentzVector
 #  DICT_LIBRARIES
 #     lardataobj_RecoBase #just for associations
-  )
+  ) ### MIGRATE-ACTION-RECOMMENDED (migrate-3.22.02) - deprecated: use art_make_library(), art_dictonary(), and cet_build_plugin() with explicit source lists and plugin base types
 install_source()
 install_headers()
diff --git a/duneprototypes/Coldbox/hd/CMakeLists.txt b/duneprototypes/Coldbox/hd/CMakeLists.txt
index 73435b4..7f96a1f 100644
--- a/duneprototypes/Coldbox/hd/CMakeLists.txt
+++ b/duneprototypes/Coldbox/hd/CMakeLists.txt
@@ -1,9 +1,5 @@
 
 cet_build_plugin(HDColdboxDataInterface   art::tool
-                                     art_utilities
-                                     canvas
-                                     cetlib
-                                     cetlib_except
                         lardataobj_RawData
                         dunepdlegacy_Overlays
                         artdaq_core::artdaq-core_Data
@@ -11,21 +7,20 @@ cet_build_plugin(HDColdboxDataInterface   art::tool
                         dunepdlegacy_Services_ChannelMap_PdspChannelMapService_service
                         dunecore::HDF5Utils
                         HDF5::HDF5
-                        ART_FRAMEWORK_CORE
-                        ART_FRAMEWORK_PRINCIPAL
-                        ART_FRAMEWORK_SERVICES_REGISTRY
-                        ART_ROOT_IO_TFILE_SUPPORT
+                        art::Framework_Core
+                        art::Framework_Principal
+                        art::Framework_Services_Registry
+                        art_root_io::tfile_support
                         ROOT::Core
-                        ART_ROOT_IO_TFILESERVICE_SERVICE
-                        ART_PERSISTENCY_PROVENANCE
+                        
+                        art::Persistency_Provenance
                         messagefacility::MF_MessageLogger
-                        CETLIB
-                        ROOT_BASIC_LIB_LIST
+                        cetlib::cetlib
+                        ROOT::Core ROOT::Hist ROOT::Tree
              )
 
 
 cet_build_plugin(HDColdboxDataInterfaceWIB3   art::tool
-                        art_utilities
                         canvas::canvas
                         cetlib::cetlib
                         cetlib_except::cetlib_except
@@ -42,7 +37,7 @@ cet_build_plugin(HDColdboxDataInterfaceWIB3   art::tool
                         art_root_io::TFileService_service
                         art::Persistency_Provenance
                         messagefacility::MF_MessageLogger
-                        ROOT_BASIC_LIB_LIST
+                        ROOT::Core ROOT::Hist ROOT::Tree
                         dunecore::HDF5Utils
                         HDF5::HDF5
              )
@@ -55,10 +50,10 @@ cet_build_plugin(HDColdboxDAQWriter art::module
                         art_root_io::tfile_support
                         ROOT::Core
                         art_root_io::TFileService_service
-                        ART_PERSISTENCY_PROVENANCE
+                        art::Persistency_Provenance
                         messagefacility::MF_MessageLogger
-                        CETLIB
-                        ROOT_BASIC_LIB_LIST
+                        cetlib::cetlib
+                        ROOT::Core ROOT::Hist ROOT::Tree
 			HDF5::HDF5
                         duneprototypes_Protodune_hd_ChannelMap_PD2HDChannelMapService_service
                         BASENAME_ONLY
diff --git a/duneprototypes/Coldbox/vd/CMakeLists.txt b/duneprototypes/Coldbox/vd/CMakeLists.txt
index 410ea4a..3c15b25 100644
--- a/duneprototypes/Coldbox/vd/CMakeLists.txt
+++ b/duneprototypes/Coldbox/vd/CMakeLists.txt
@@ -1,6 +1,5 @@
 
 cet_build_plugin(VDColdboxDataInterface   art::tool
-                                     art_utilities
                                      canvas::canvas
                                      cetlib::cetlib
                                      cetlib_except::cetlib_except
@@ -12,37 +11,36 @@ cet_build_plugin(VDColdboxDataInterface   art::tool
                         dunecore::HDF5Utils
                         HDF5::HDF5
                         duneprototypes_Coldbox_vd_ChannelMap_VDColdboxChannelMapService_service
-                        ART_FRAMEWORK_CORE
-                        ART_FRAMEWORK_PRINCIPAL
-                        ART_FRAMEWORK_SERVICES_REGISTRY
-                        ART_ROOT_IO_TFILE_SUPPORT
+                        art::Framework_Core
+                        art::Framework_Principal
+                        art::Framework_Services_Registry
+                        art_root_io::tfile_support
                         ROOT::Core
-                        ART_ROOT_IO_TFILESERVICE_SERVICE
-                        ART_PERSISTENCY_PROVENANCE
+                        
+                        art::Persistency_Provenance
                         messagefacility::MF_MessageLogger
-                        CETLIB
-                        ROOT_BASIC_LIB_LIST
+                        cetlib::cetlib
+                        ROOT::Core ROOT::Hist ROOT::Tree
              )
 
 
 simple_plugin(VDColdboxTDERawInput "source"
   duneprototypes_Coldbox_vd_ChannelMap_VDColdboxTDEChannelMapService_service
   art::Framework_Services_Registry
-  art_utilities
   canvas::canvas
   cetlib::cetlib
   cetlib_except::cetlib_except
   lardataobj_RawData
-  ART_FRAMEWORK_CORE
-  ART_FRAMEWORK_PRINCIPAL
-  ART_FRAMEWORK_SERVICES_REGISTRY
-  ART_ROOT_IO_TFILE_SUPPORT
+  art::Framework_Core
+  art::Framework_Principal
+  art::Framework_Services_Registry
+  art_root_io::tfile_support
   ROOT::Core
-  ART_ROOT_IO_TFILESERVICE_SERVICE
-  ART_PERSISTENCY_PROVENANCE
+  
+  art::Persistency_Provenance
   messagefacility::MF_MessageLogger
-  ROOT_BASIC_LIB_LIST
-)
+  ROOT::Core ROOT::Hist ROOT::Tree
+) ### MIGRATE-ACTION-RECOMMENDED (migrate-3.22.02) - deprecated: use cet_build_plugin() with explicit source lists and plugin base types
 
 
 cet_build_plugin(VDColdboxPDSDecoder art::module
@@ -50,16 +48,16 @@ cet_build_plugin(VDColdboxPDSDecoder art::module
                  lardataobj_RecoBase
                  dunecore::HDF5Utils
                  HDF5::HDF5
-                 ART_FRAMEWORK_CORE
-                 ART_FRAMEWORK_PRINCIPAL
-                 ART_FRAMEWORK_SERVICES_REGISTRY
-                 ART_ROOT_IO_TFILE_SUPPORT
+                 art::Framework_Core
+                 art::Framework_Principal
+                 art::Framework_Services_Registry
+                 art_root_io::tfile_support
                  ROOT::Core
-                 ART_ROOT_IO_TFILESERVICE_SERVICE
-                 ART_PERSISTENCY_PROVENANCE
+                 
+                 art::Persistency_Provenance
                  messagefacility::MF_MessageLogger
-                 CETLIB
-                 ROOT_BASIC_LIB_LIST
+                 cetlib::cetlib
+                 ROOT::Core ROOT::Hist ROOT::Tree
                  BASENAME_ONLY
 )
 
diff --git a/duneprototypes/Coldbox/vd/ChannelMap/CMakeLists.txt b/duneprototypes/Coldbox/vd/ChannelMap/CMakeLists.txt
old mode 100755
new mode 100644
index 6a74442..3aba4fb
--- a/duneprototypes/Coldbox/vd/ChannelMap/CMakeLists.txt
+++ b/duneprototypes/Coldbox/vd/ChannelMap/CMakeLists.txt
@@ -23,8 +23,8 @@ simple_plugin(VDColdboxChannelMapService "service"
               SQLite::SQLite3
               messagefacility::MF_MessageLogger
               ${CETLIB_LIBS}
-              ROOT_BASIC_LIB_LIST
-)
+              ROOT::Core ROOT::Hist ROOT::Tree
+) ### MIGRATE-ACTION-RECOMMENDED (migrate-3.22.02) - deprecated: use cet_build_plugin() with explicit source lists and plugin base types
 
 simple_plugin(VDColdboxTDEChannelMapService "service"
               ${ART_PERSISTENCY_ROOTDB}
@@ -33,5 +33,5 @@ simple_plugin(VDColdboxTDEChannelMapService "service"
               SQLite::SQLite3
               messagefacility::MF_MessageLogger
               ${CETLIB_LIBS}
-              ROOT_BASIC_LIB_LIST
-)
+              ROOT::Core ROOT::Hist ROOT::Tree
+) ### MIGRATE-ACTION-RECOMMENDED (migrate-3.22.02) - deprecated: use cet_build_plugin() with explicit source lists and plugin base types
diff --git a/duneprototypes/Coldbox/vd/Tools/CMakeLists.txt b/duneprototypes/Coldbox/vd/Tools/CMakeLists.txt
index 058a35a..749db8c 100644
--- a/duneprototypes/Coldbox/vd/Tools/CMakeLists.txt
+++ b/duneprototypes/Coldbox/vd/Tools/CMakeLists.txt
@@ -2,24 +2,24 @@ cet_build_plugin(VDColdboxChannelRanges  art::tool
                 dunecore_ArtSupport
                 art::Utilities canvas
                 cetlib::cetlib cetlib_except
-                ROOT_BASIC_LIB_LIST
+                ROOT::Core ROOT::Hist ROOT::Tree
              )
 
 cet_build_plugin(VDColdboxChannelGroups  art::tool
                 dunecore_ArtSupport
                 art::Utilities canvas
                 cetlib::cetlib cetlib_except
-                ROOT_BASIC_LIB_LIST
+                ROOT::Core ROOT::Hist ROOT::Tree
              )
 
 
 cet_build_plugin(VDColdboxOnlineChannel  art::tool
                 duneprototypes_Coldbox_vd_ChannelMap_VDColdboxChannelMapService_service
                 dunecore_ArtSupport
-                ART_FRAMEWORK_SERVICES_REGISTRY
+                art::Framework_Services_Registry
                 art::Utilities canvas
                 cetlib::cetlib cetlib_except
-                ROOT_BASIC_LIB_LIST
+                ROOT::Core ROOT::Hist ROOT::Tree
              )
 
 cet_build_plugin(CrpChannelRanges  art::tool
@@ -27,7 +27,7 @@ cet_build_plugin(CrpChannelRanges  art::tool
                 dunecore_DuneCommon_Utility
                 art::Utilities canvas
                 cetlib::cetlib cetlib_except
-                ROOT_BASIC_LIB_LIST
+                ROOT::Core ROOT::Hist ROOT::Tree
              )
 
 cet_build_plugin(CrpChannelGroups  art::tool
@@ -35,7 +35,7 @@ cet_build_plugin(CrpChannelGroups  art::tool
                 dunecore_DuneCommon_Utility
                 art::Utilities canvas
                 cetlib::cetlib cetlib_except
-                ROOT_BASIC_LIB_LIST
+                ROOT::Core ROOT::Hist ROOT::Tree
              )
 
 
diff --git a/duneprototypes/Coldbox/vd/Tools/test/CMakeLists.txt b/duneprototypes/Coldbox/vd/Tools/test/CMakeLists.txt
index 9844b1c..657b188 100644
--- a/duneprototypes/Coldbox/vd/Tools/test/CMakeLists.txt
+++ b/duneprototypes/Coldbox/vd/Tools/test/CMakeLists.txt
@@ -15,8 +15,8 @@ cet_test(test_VDColdboxChannelRanges SOURCES test_VDColdboxChannelRanges.cxx
     fhiclcpp
     cetlib::cetlib cetlib_except
     cetlib_except::cetlib_except
-    ROOT_BASIC_LIB_LIST
-    SQLITE3
+    ROOT::Core ROOT::Hist ROOT::Tree
+    SQLite::SQLite3
     Boost::filesystem
 )
 
@@ -28,8 +28,8 @@ cet_test(test_VDColdboxChannelGroups SOURCES test_VDColdboxChannelGroups.cxx
     fhiclcpp
     cetlib::cetlib cetlib_except
     cetlib_except::cetlib_except
-    ROOT_BASIC_LIB_LIST
-    SQLITE3
+    ROOT::Core ROOT::Hist ROOT::Tree
+    SQLite::SQLite3
     Boost::filesystem
 )
 
@@ -41,8 +41,8 @@ cet_test(test_VDColdboxOnlineChannel SOURCES test_VDColdboxOnlineChannel.cxx
     fhiclcpp
     cetlib::cetlib cetlib_except
     cetlib_except::cetlib_except
-    ROOT_BASIC_LIB_LIST
-    SQLITE3
+    ROOT::Core ROOT::Hist ROOT::Tree
+    SQLite::SQLite3
     Boost::filesystem
 )
 
@@ -55,8 +55,8 @@ cet_test(test_CrpChannelRanges SOURCES test_CrpChannelRanges.cxx
     fhiclcpp
     cetlib::cetlib cetlib_except
     cetlib_except::cetlib_except
-    ROOT_BASIC_LIB_LIST
-    SQLITE3
+    ROOT::Core ROOT::Hist ROOT::Tree
+    SQLite::SQLite3
     Boost::filesystem
 )
 
@@ -69,8 +69,8 @@ cet_test(test_CrpChannelGroups SOURCES test_CrpChannelGroups.cxx
     fhiclcpp
     cetlib::cetlib cetlib_except
     cetlib_except::cetlib_except
-    ROOT_BASIC_LIB_LIST
-    SQLITE3
+    ROOT::Core ROOT::Hist ROOT::Tree
+    SQLite::SQLite3
     Boost::filesystem
 )
 
diff --git a/duneprototypes/Iceberg/Monitor/CMakeLists.txt b/duneprototypes/Iceberg/Monitor/CMakeLists.txt
index 532efe0..5c6139f 100644
--- a/duneprototypes/Iceberg/Monitor/CMakeLists.txt
+++ b/duneprototypes/Iceberg/Monitor/CMakeLists.txt
@@ -5,16 +5,16 @@ cet_build_plugin(IcebergTpcMonitor art::module
               lardataobj_RawData
               nusimdata::SimulationBase
               dunepdlegacy_Services_ChannelMap_IcebergChannelMapService_service
-              ART_FRAMEWORK_CORE
-              ART_FRAMEWORK_PRINCIPAL
-              ART_FRAMEWORK_SERVICES_REGISTRY
-              ART_ROOT_IO_TFILE_SUPPORT
+              art::Framework_Core
+              art::Framework_Principal
+              art::Framework_Services_Registry
+              art_root_io::tfile_support
               ROOT::Core
-              ART_ROOT_IO_TFILESERVICE_SERVICE
-              ART_PERSISTENCY_PROVENANCE
+              
+              art::Persistency_Provenance
               messagefacility::MF_MessageLogger
-              CETLIB
-              ROOT_BASIC_LIB_LIST
+              cetlib::cetlib
+              ROOT::Core ROOT::Hist ROOT::Tree
               BASENAME_ONLY)
 
 install_headers()
diff --git a/duneprototypes/Iceberg/RawDecoding/CMakeLists.txt b/duneprototypes/Iceberg/RawDecoding/CMakeLists.txt
index 83bbc5d..e5d1260 100644
--- a/duneprototypes/Iceberg/RawDecoding/CMakeLists.txt
+++ b/duneprototypes/Iceberg/RawDecoding/CMakeLists.txt
@@ -16,7 +16,7 @@ cet_build_plugin(IcebergTPCRawDecoder art::module
                         art_root_io::TFileService_service
                         art::Persistency_Provenance
                         messagefacility::MF_MessageLogger
-                        ROOT_BASIC_LIB_LIST
+                        ROOT::Core ROOT::Hist ROOT::Tree
                         dunepdlegacy_rce_dataaccess
                         z
                         BASENAME_ONLY
@@ -37,7 +37,7 @@ cet_build_plugin(IcebergFELIXBufferDecoderMarch2021 art::module
                         art_root_io::TFileService_service
                         art::Persistency_Provenance
                         messagefacility::MF_MessageLogger
-                        ROOT_BASIC_LIB_LIST
+                        ROOT::Core ROOT::Hist ROOT::Tree
                         dunepdlegacy_rce_dataaccess
                         z
                         cetlib::cetlib
@@ -45,7 +45,6 @@ cet_build_plugin(IcebergFELIXBufferDecoderMarch2021 art::module
 )
 
 cet_build_plugin(IcebergDataInterface   art::tool
-                                     art_utilities
                                      canvas::canvas
                                      cetlib::cetlib
                                      cetlib_except::cetlib_except
@@ -62,14 +61,13 @@ cet_build_plugin(IcebergDataInterface   art::tool
                         art_root_io::TFileService_service
                         art::Persistency_Provenance
                         messagefacility::MF_MessageLogger
-                        ROOT_BASIC_LIB_LIST
+                        ROOT::Core ROOT::Hist ROOT::Tree
                         dunepdlegacy_rce_dataaccess
                         z
              )
 
 
 cet_build_plugin(IcebergDataInterfaceFELIXBufferMarch2021   art::tool
-                                     art_utilities
                                      canvas::canvas
                                      cetlib::cetlib
                                      cetlib_except::cetlib_except
@@ -86,13 +84,12 @@ cet_build_plugin(IcebergDataInterfaceFELIXBufferMarch2021   art::tool
                         art_root_io::TFileService_service
                         art::Persistency_Provenance
                         messagefacility::MF_MessageLogger
-                        ROOT_BASIC_LIB_LIST
+                        ROOT::Core ROOT::Hist ROOT::Tree
                         z
              )
 
 
 cet_build_plugin(IcebergHDF5DataInterface   art::tool
-                        art_utilities
                         canvas::canvas
                         cetlib::cetlib
                         cetlib_except::cetlib_except
@@ -109,7 +106,7 @@ cet_build_plugin(IcebergHDF5DataInterface   art::tool
                         art_root_io::TFileService_service
                         art::Persistency_Provenance
                         messagefacility::MF_MessageLogger
-                        ROOT_BASIC_LIB_LIST
+                        ROOT::Core ROOT::Hist ROOT::Tree
 			dunecore::HDF5Utils
                         HDF5::HDF5
              )
diff --git a/duneprototypes/Iceberg/Signal2Noise/CMakeLists.txt b/duneprototypes/Iceberg/Signal2Noise/CMakeLists.txt
index b23979b..74e3c28 100644
--- a/duneprototypes/Iceberg/Signal2Noise/CMakeLists.txt
+++ b/duneprototypes/Iceberg/Signal2Noise/CMakeLists.txt
@@ -10,20 +10,20 @@ art_make(
   larana_OpticalDetector_OpDigiProperties_service
   lardata_Utilities
   nusimdata::SimulationBase
-  ART_FRAMEWORK_CORE
-  ART_FRAMEWORK_PRINCIPAL
-  ART_FRAMEWORK_SERVICES_REGISTRY
-  ART_ROOT_IO_TFILE_SUPPORT
+  art::Framework_Core
+  art::Framework_Principal
+  art::Framework_Services_Registry
+  art_root_io::tfile_support
   ROOT::Core
-  ART_ROOT_IO_TFILESERVICE_SERVICE
-  ART_FRAMEWORK_SERVICES_OPTIONAL_RANDOMNUMBERGENERATOR_SERVICE
+  
+  
   art::Persistency_Common
   art::Utilities
   canvas::canvas
   messagefacility::MF_MessageLogger
   fhiclcpp::fhiclcpp
   cetlib::cetlib cetlib_except
-  ROOT_BASIC_LIB_LIST
+  ROOT::Core ROOT::Hist ROOT::Tree
   MODULE_LIBRARIES larana_OpticalDetector_OpDigiProperties_service
   larana_OpticalDetector_OpHitFinder
   larana_OpticalDetector
@@ -45,39 +45,39 @@ art_make(
   lardataobj_AnalysisBase
   nurandom::RandomUtils_NuRandomService_service
   nusimdata::SimulationBase
-  ART_FRAMEWORK_CORE
-  ART_FRAMEWORK_PRINCIPAL
-  ART_FRAMEWORK_SERVICES_REGISTRY
-  ART_ROOT_IO_TFILE_SUPPORT
+  art::Framework_Core
+  art::Framework_Principal
+  art::Framework_Services_Registry
+  art_root_io::tfile_support
   ROOT::Core
-  ART_ROOT_IO_TFILESERVICE_SERVICE
-  ART_FRAMEWORK_SERVICES_OPTIONAL_RANDOMNUMBERGENERATOR_SERVICE
-  ART_PERSISTENCY_PROVENANCE
+  
+  
+  art::Persistency_Provenance
   art::Persistency_Common
   art::Utilities
   canvas::canvas
   messagefacility::MF_MessageLogger
   fhiclcpp::fhiclcpp
   cetlib::cetlib cetlib_except
-  ROOT_BASIC_LIB_LIST
+  ROOT::Core ROOT::Hist ROOT::Tree
   SERVICE_LIBRARIES
   larcorealg_Geometry
   larcore_Geometry_Geometry_service
-  ART_FRAMEWORK_CORE
-  ART_FRAMEWORK_PRINCIPAL
-  ART_FRAMEWORK_SERVICES_REGISTRY
-  ART_ROOT_IO_TFILE_SUPPORT
+  art::Framework_Core
+  art::Framework_Principal
+  art::Framework_Services_Registry
+  art_root_io::tfile_support
   ROOT::Core
-  ART_ROOT_IO_TFILESERVICE_SERVICE
+  
   art::Persistency_Common
   art::Utilities
   canvas::canvas
   messagefacility::MF_MessageLogger
   fhiclcpp::fhiclcpp
   cetlib::cetlib cetlib_except
-  CLHEP
-  ROOT_BASIC_LIB_LIST
-  )
+  CLHEP::CLHEP
+  ROOT::Core ROOT::Hist ROOT::Tree
+  ) ### MIGRATE-ACTION-RECOMMENDED (migrate-3.22.02) - deprecated: use art_make_library(), art_dictonary(), and cet_build_plugin() with explicit source lists and plugin base types
 
 install_headers()
 install_fhicl()
diff --git a/duneprototypes/Iceberg/icebergpd/CMakeLists.txt b/duneprototypes/Iceberg/icebergpd/CMakeLists.txt
index 05b5259..ab226b7 100644
--- a/duneprototypes/Iceberg/icebergpd/CMakeLists.txt
+++ b/duneprototypes/Iceberg/icebergpd/CMakeLists.txt
@@ -4,16 +4,16 @@ cet_build_plugin(ICEBERGPDSSPMonitor art::module
               lardataobj_RawData
               nusimdata::SimulationBase
               dunepdlegacy_Services_ChannelMap_IcebergChannelMapService_service
-              ART_FRAMEWORK_CORE
-              ART_FRAMEWORK_PRINCIPAL
-              ART_FRAMEWORK_SERVICES_REGISTRY
-              ART_ROOT_IO_TFILE_SUPPORT
+              art::Framework_Core
+              art::Framework_Principal
+              art::Framework_Services_Registry
+              art_root_io::tfile_support
               ROOT::Core
-              ART_ROOT_IO_TFILESERVICE_SERVICE
-              ART_PERSISTENCY_PROVENANCE
+              
+              art::Persistency_Provenance
               messagefacility::MF_MessageLogger
-              CETLIB
-              ROOT_BASIC_LIB_LIST
+              cetlib::cetlib
+              ROOT::Core ROOT::Hist ROOT::Tree
               BASENAME_ONLY)
 
 install_headers()
diff --git a/duneprototypes/Protodune/dualphase/CMakeLists.txt b/duneprototypes/Protodune/dualphase/CMakeLists.txt
index 8fafcd2..54cd820 100644
--- a/duneprototypes/Protodune/dualphase/CMakeLists.txt
+++ b/duneprototypes/Protodune/dualphase/CMakeLists.txt
@@ -6,20 +6,20 @@ cet_build_plugin(
            cetlib::cetlib
            cetlib_except::cetlib_except
            fhiclcpp::fhiclcpp
-           CLHEP
+           CLHEP::CLHEP
            larcorealg_Geometry
            larcoreobj_SummaryData
            larsim_EventGenerator
            nurandom::RandomUtils_NuRandomService_service
-           ART_FRAMEWORK_SERVICES_REGISTRY
-           ART_ROOT_IO_TFILESERVICE_SERVICE
-           ART_ROOT_IO_TFILE_SUPPORT
-           CLHEP
+           art::Framework_Services_Registry
+           larsim_MCCheater_ParticleInventoryService 
+           art_root_io::tfile_support
+           CLHEP::CLHEP
            messagefacility::MF_MessageLogger
-  	   ROOT_BASIC_LIB_LIST
-           ROOT_GEOM
-           ROOT_XMLIO
-           ROOT_GDML
+  	   ROOT::Core ROOT::Hist ROOT::Tree
+           ROOT::Geom
+           ROOT::XMLIO
+           ROOT::Gdml
 )
 if(FALSE)
 cet_build_plugin(
@@ -32,21 +32,22 @@ cet_build_plugin(
                         lardata_ArtDataHelper
                         lardata_Utilities
                         lardataobj_Simulation
-                        larsim_MCCheater_BackTrackerService_service
-           larsim_MCCheater_ParticleInventoryService_service
-                        ART_FRAMEWORK_CORE
-                        ART_FRAMEWORK_PRINCIPAL
-                        ART_FRAMEWORK_SERVICES_REGISTRY
-                        ART_ROOT_IO_TFILE_SUPPORT
+                        larsim_MCCheater_BackTrackerService
+                        larsim_MCCheater_ParticleInventoryService_service
+                        larsim_MCCheater_ParticleInventoryService 
+                        art::Framework_Core
+                        art::Framework_Principal
+                        art::Framework_Services_Registry
+                        art_root_io::tfile_support
                         ROOT::Core
-                        ART_ROOT_IO_TFILESERVICE_SERVICE
+                        
                         art::Persistency_Common canvas
                         art::Persistency_Provenance canvas
                         art::Utilities canvas
                         messagefacility::MF_MessageLogger
                         
                         cetlib::cetlib cetlib_except
-                        ROOT_BASIC_LIB_LIST
+                        ROOT::Core ROOT::Hist ROOT::Tree
                         BASENAME_ONLY
 )
 endif()
@@ -61,19 +62,19 @@ cet_build_plugin(
                         lardata_Utilities
                         lardataobj_Simulation
                         larsim_MCCheater_BackTrackerService_service
-                        ART_FRAMEWORK_CORE
-                        ART_FRAMEWORK_PRINCIPAL
-                        ART_FRAMEWORK_SERVICES_REGISTRY
-                        ART_ROOT_IO_TFILE_SUPPORT
+                        art::Framework_Core
+                        art::Framework_Principal
+                        art::Framework_Services_Registry
+                        art_root_io::tfile_support
                         ROOT::Core
-                        ART_ROOT_IO_TFILESERVICE_SERVICE
+                        
                         art::Persistency_Common canvas
                         art::Persistency_Provenance canvas
                         art::Utilities canvas
                         messagefacility::MF_MessageLogger
                         
                         cetlib::cetlib cetlib_except
-                        ROOT_BASIC_LIB_LIST
+                        ROOT::Core ROOT::Hist ROOT::Tree
                         BASENAME_ONLY
 )
 
@@ -81,6 +82,8 @@ cet_build_plugin(
 	  AnaRootParser art::module
 	  larcore_Geometry_Geometry_service
 	  larsim_Simulation nug4::ParticleNavigation lardataobj_Simulation
+          larsim_MCCheater_ParticleInventoryService 
+	  larsim_MCCheater_BackTrackerService
 	  larsim_MCCheater_BackTrackerService_service
           larsim_MCCheater_ParticleInventoryService_service
 	  lardata_Utilities
@@ -97,12 +100,12 @@ cet_build_plugin(
 	  dunecore::SignalShapingServiceDUNE10kt_service
 	  dunecore::SignalShapingServiceDUNE35t_service
           nusimdata::SimulationBase
-          ART_FRAMEWORK_CORE
-	  ART_FRAMEWORK_PRINCIPAL
-	  ART_FRAMEWORK_SERVICES_REGISTRY
-	  ART_ROOT_IO_TFILE_SUPPORT
+          art::Framework_Core
+	  art::Framework_Principal
+	  art::Framework_Services_Registry
+	  art_root_io::tfile_support
 	  ROOT::Core
-	  ART_ROOT_IO_TFILESERVICE_SERVICE
+	  
 	  art::Persistency_Common canvas
 	  art::Persistency_Provenance canvas
 	  art::Utilities canvas
@@ -110,10 +113,10 @@ cet_build_plugin(
 	  
 	  fhiclcpp::fhiclcpp
 	  cetlib::cetlib cetlib_except
-          ROOT_GEOM
-          ROOT_XMLIO
-          ROOT_GDML
-	  ROOT_BASIC_LIB_LIST
+          ROOT::Geom
+          ROOT::XMLIO
+          ROOT::Gdml
+	  ROOT::Core ROOT::Hist ROOT::Tree
 )
 
 
diff --git a/duneprototypes/Protodune/dualphase/Light/CMakeLists.txt b/duneprototypes/Protodune/dualphase/Light/CMakeLists.txt
index 350555b..b70bf00 100644
--- a/duneprototypes/Protodune/dualphase/Light/CMakeLists.txt
+++ b/duneprototypes/Protodune/dualphase/Light/CMakeLists.txt
@@ -2,27 +2,27 @@ art_make( BASENAME_ONLY MODULE_LIBRARIES
   larcore_Geometry_Geometry_service
   larcorealg_Geometry
   lardataobj_RawData
-  larsim_MCCheater_BackTrackerService_service
-  larsim_MCCheater_PhotonBackTrackerService_service
-  larsim_MCCheater_ParticleInventoryService_service
+  larsim_MCCheater_ParticleInventoryService
+  larsim::MCCheater_BackTrackerService_service
+  larsim::MCCheater_PhotonBackTrackerService_service
+  larsim::MCCheater_ParticleInventoryService_service
   larsim_Simulation
   nug4::ParticleNavigation
   lardataobj_Simulation
   nusimdata::SimulationBase	
-  ART_FRAMEWORK_CORE
-  ART_FRAMEWORK_PRINCIPAL
-  ART_FRAMEWORK_SERVICES_REGISTRY
-  ART_ROOT_IO_TFILE_SUPPORT
+  art::Framework_Core
+  art::Framework_Principal
+  art::Framework_Services_Registry
+  art_root_io::tfile_support
   ROOT::Core
-  ART_ROOT_IO_TFILESERVICE_SERVICE
   art::Persistency_Common canvas
   art::Persistency_Provenance canvas
   art::Utilities canvas
   messagefacility::MF_MessageLogger
-  ROOT_GEOM
+  ROOT::Geom
   cetlib::cetlib cetlib_except
-  ROOT_BASIC_LIB_LIST
-  )
+  ROOT::Core ROOT::Hist ROOT::Tree
+  ) ### MIGRATE-ACTION-RECOMMENDED (migrate-3.22.02) - deprecated: use art_make_library(), art_dictonary(), and cet_build_plugin() with explicit source lists and plugin base types
 
 install_fhicl()
 install_headers()
diff --git a/duneprototypes/Protodune/dualphase/RawDecoding/CMakeLists.txt b/duneprototypes/Protodune/dualphase/RawDecoding/CMakeLists.txt
index 8c32bb4..5e3c630 100644
--- a/duneprototypes/Protodune/dualphase/RawDecoding/CMakeLists.txt
+++ b/duneprototypes/Protodune/dualphase/RawDecoding/CMakeLists.txt
@@ -1,14 +1,14 @@
 cet_build_plugin(PDDPChannelMap art::service
-                        ART_FRAMEWORK_CORE
-			ART_FRAMEWORK_IO_SOURCES
-                        ART_FRAMEWORK_PRINCIPAL
+                        art::Framework_Core
+			art::Framework_IO_Sources
+                        art::Framework_Principal
                         art::Persistency_Common canvas
 			art::Persistency_Provenance canvas
 			art::Utilities canvas
 			fhiclcpp::fhiclcpp
                         messagefacility::MF_MessageLogger
-                        CETLIB
-                        ROOT_BASIC_LIB_LIST
+                        cetlib::cetlib
+                        ROOT::Core ROOT::Hist ROOT::Tree
                         BASENAME_ONLY
 )
 
@@ -16,16 +16,16 @@ cet_build_plugin(PDDPRawInput art::source
 			PDDPRawInputDriver_service
                         lardataobj_RawData
                         lardata_Utilities
-                        ART_FRAMEWORK_CORE
-			ART_FRAMEWORK_IO_SOURCES
-                        ART_FRAMEWORK_PRINCIPAL
+                        art::Framework_Core
+			art::Framework_IO_Sources
+                        art::Framework_Principal
                         art::Persistency_Common canvas
 			art::Persistency_Provenance canvas
 			art::Utilities canvas
 			fhiclcpp::fhiclcpp
                         messagefacility::MF_MessageLogger
-                        CETLIB
-                        ROOT_BASIC_LIB_LIST
+                        cetlib::cetlib
+                        ROOT::Core ROOT::Hist ROOT::Tree
                         BASENAME_ONLY
 )
 
@@ -34,34 +34,34 @@ cet_build_plugin(PDDPRawInputDriver art::service
 			pthread
 			lardataobj_RawData
                         lardata_Utilities
-                        ART_FRAMEWORK_CORE
-			ART_FRAMEWORK_IO_SOURCES
-                        ART_FRAMEWORK_PRINCIPAL
+                        art::Framework_Core
+			art::Framework_IO_Sources
+                        art::Framework_Principal
                         art::Persistency_Common canvas
 			art::Persistency_Provenance canvas
 			art::Utilities canvas
 			fhiclcpp::fhiclcpp
                         messagefacility::MF_MessageLogger
-                        CETLIB
-                        ROOT_BASIC_LIB_LIST
+                        cetlib::cetlib
+                        ROOT::Core ROOT::Hist ROOT::Tree
                         BASENAME_ONLY
 )
 
 cet_build_plugin(PDDPTPCRawDecoderTest art::module
 			lardataobj_RawData
-                        ART_FRAMEWORK_CORE
-			ART_FRAMEWORK_PRINCIPAL
-			ART_FRAMEWORK_SERVICES_REGISTRY
-                        ART_ROOT_IO_TFILE_SUPPORT
+                        art::Framework_Core
+			art::Framework_Principal
+			art::Framework_Services_Registry
+                        art_root_io::tfile_support
                         ROOT::Core
-                        ART_ROOT_IO_TFILESERVICE_SERVICE
+                        
  			art::Persistency_Common canvas
 			art::Persistency_Provenance canvas
 			art::Utilities canvas
 			messagefacility::MF_MessageLogger
 			
 			cetlib::cetlib cetlib_except
-			ROOT_BASIC_LIB_LIST
+			ROOT::Core ROOT::Hist ROOT::Tree
               		BASENAME_ONLY
 )
 
diff --git a/duneprototypes/Protodune/hd/ChannelMap/CMakeLists.txt b/duneprototypes/Protodune/hd/ChannelMap/CMakeLists.txt
index 27dc6c9..c427dcf 100644
--- a/duneprototypes/Protodune/hd/ChannelMap/CMakeLists.txt
+++ b/duneprototypes/Protodune/hd/ChannelMap/CMakeLists.txt
@@ -13,4 +13,4 @@ art_make(SERVICE_LIBRARIES
                            messagefacility::MF_MessageLogger
                            ROOT::Core
  	                   duneprototypes::Protodune_hd_ChannelMap
-)
+) ### MIGRATE-ACTION-RECOMMENDED (migrate-3.22.02) - deprecated: use art_make_library(), art_dictonary(), and cet_build_plugin() with explicit source lists and plugin base types
diff --git a/duneprototypes/Protodune/hd/RawDecoding/CMakeLists.txt b/duneprototypes/Protodune/hd/RawDecoding/CMakeLists.txt
index 6c61efe..ddf3ca1 100644
--- a/duneprototypes/Protodune/hd/RawDecoding/CMakeLists.txt
+++ b/duneprototypes/Protodune/hd/RawDecoding/CMakeLists.txt
@@ -14,7 +14,7 @@ cet_build_plugin(DAPHNEReaderPDHD art::module
                  art_root_io::TFileService_service
                  art::Persistency_Provenance
                  messagefacility::MF_MessageLogger
-                 ROOT_BASIC_LIB_LIST
+                 ROOT::Core ROOT::Hist ROOT::Tree
                  BASENAME_ONLY
 )
 
@@ -32,12 +32,11 @@ cet_build_plugin(PDHDTPCReader art::module
                         art_root_io::TFileService_service
                         art::Persistency_Provenance
                         messagefacility::MF_MessageLogger
-                        ROOT_BASIC_LIB_LIST
+                        ROOT::Core ROOT::Hist ROOT::Tree
                         BASENAME_ONLY
 )
 
 cet_build_plugin(PDHDDataInterfaceWIB3   art::tool
-                        art_utilities
                         canvas::canvas
                         cetlib::cetlib
                         cetlib_except::cetlib_except
@@ -54,14 +53,13 @@ cet_build_plugin(PDHDDataInterfaceWIB3   art::tool
                         art_root_io::TFileService_service
                         art::Persistency_Provenance
                         messagefacility::MF_MessageLogger
-                        ROOT_BASIC_LIB_LIST
+                        ROOT::Core ROOT::Hist ROOT::Tree
 			dunecore::HDF5Utils_HDF5RawFile2Service_service
 			dunecore::dunedaqhdf5utils2
                         HDF5::HDF5
              )
 
 cet_build_plugin(PDHDDataInterfaceWIBEth   art::tool
-                        art_utilities
                         canvas::canvas
                         cetlib::cetlib
                         cetlib_except::cetlib_except
@@ -78,7 +76,7 @@ cet_build_plugin(PDHDDataInterfaceWIBEth   art::tool
                         art_root_io::TFileService_service
                         art::Persistency_Provenance
                         messagefacility::MF_MessageLogger
-                        ROOT_BASIC_LIB_LIST
+                        ROOT::Core ROOT::Hist ROOT::Tree
 			dunecore::HDF5Utils_HDF5RawFile2Service_service
 			dunecore::dunedaqhdf5utils2
                         HDF5::HDF5
@@ -103,7 +101,7 @@ cet_build_plugin(PDHDTriggerReader art::module
                         messagefacility::MF_MessageLogger
                         dunecore::HDF5Utils_HDF5RawFile2Service_service
                         dunecore::dunedaqhdf5utils2
-                        ROOT_BASIC_LIB_LIST
+                        ROOT::Core ROOT::Hist ROOT::Tree
                         BASENAME_ONLY
                 )
 
diff --git a/duneprototypes/Protodune/hd/Tool/CMakeLists.txt b/duneprototypes/Protodune/hd/Tool/CMakeLists.txt
index a0d2d5e..600a156 100644
--- a/duneprototypes/Protodune/hd/Tool/CMakeLists.txt
+++ b/duneprototypes/Protodune/hd/Tool/CMakeLists.txt
@@ -9,16 +9,16 @@ cet_build_plugin(PdhdChannelRanges   art::tool
                  dunecore_ArtSupport
                  art::Utilities canvas
                  cetlib::cetlib cetlib_except
-                 ART_FRAMEWORK_SERVICES_REGISTRY
-                 ROOT_BASIC_LIB_LIST
+                 art::Framework_Services_Registry
+                 ROOT::Core ROOT::Hist ROOT::Tree
                 )
 
 cet_build_plugin(PdhdChannelGroups   art::tool
                  dunecore_ArtSupport
                  art::Utilities canvas
                  cetlib::cetlib cetlib_except
-                 ART_FRAMEWORK_SERVICES_REGISTRY
-                 ROOT_BASIC_LIB_LIST
+                 art::Framework_Services_Registry
+                 ROOT::Core ROOT::Hist ROOT::Tree
                 )
 
 add_subdirectory(test)
diff --git a/duneprototypes/Protodune/hd/Tool/test/CMakeLists.txt b/duneprototypes/Protodune/hd/Tool/test/CMakeLists.txt
index eebea34..bad37b3 100644
--- a/duneprototypes/Protodune/hd/Tool/test/CMakeLists.txt
+++ b/duneprototypes/Protodune/hd/Tool/test/CMakeLists.txt
@@ -13,8 +13,8 @@ cet_test(test_PdhdChannelRanges SOURCES test_PdhdChannelRanges.cxx
     fhiclcpp
     cetlib::cetlib cetlib_except
     cetlib_except::cetlib_except
-    ROOT_BASIC_LIB_LIST
-    SQLITE3
+    ROOT::Core ROOT::Hist ROOT::Tree
+    SQLite::SQLite3
     Boost::filesystem
 )
 
@@ -26,8 +26,8 @@ cet_test(test_PdhdChannelGroups SOURCES test_PdhdChannelGroups.cxx
     fhiclcpp
     cetlib::cetlib cetlib_except
     cetlib_except::cetlib_except
-    ROOT_BASIC_LIB_LIST
-    SQLITE3
+    ROOT::Core ROOT::Hist ROOT::Tree
+    SQLite::SQLite3
     Boost::filesystem
 )
 include(CetTest)
diff --git a/duneprototypes/Protodune/hd/fcl/test/CMakeLists.txt b/duneprototypes/Protodune/hd/fcl/test/CMakeLists.txt
index 29924fa..1566ef3 100644
--- a/duneprototypes/Protodune/hd/fcl/test/CMakeLists.txt
+++ b/duneprototypes/Protodune/hd/fcl/test/CMakeLists.txt
@@ -15,7 +15,7 @@ cet_test(test_fcl_pdhdChannelFemb SOURCES test_fcl_pdhdChannelFemb.cxx
     fhiclcpp
     cetlib::cetlib cetlib_except
     cetlib_except::cetlib_except
-    ROOT_BASIC_LIB_LIST
-    SQLITE3
+    ROOT::Core ROOT::Hist ROOT::Tree
+    SQLite::SQLite3
     Boost::filesystem
 )
diff --git a/duneprototypes/Protodune/singlephase/BeamReco/CMakeLists.txt b/duneprototypes/Protodune/singlephase/BeamReco/CMakeLists.txt
index 4a20078..c99d5d9 100644
--- a/duneprototypes/Protodune/singlephase/BeamReco/CMakeLists.txt
+++ b/duneprototypes/Protodune/singlephase/BeamReco/CMakeLists.txt
@@ -21,20 +21,19 @@ art_make(  MODULE_LIBRARIES
                         larsim_MCCheater_ParticleInventoryService_service
                         nug4::ParticleNavigation 
                         nusimdata::SimulationBase
-                        ART_FRAMEWORK_CORE
-                        ART_FRAMEWORK_PRINCIPAL
-                        ART_FRAMEWORK_SERVICES_REGISTRY
-                        ART_ROOT_IO_TFILE_SUPPORT
+                        art::Framework_Core
+                        art::Framework_Principal
+                        art::Framework_Services_Registry
+                        art_root_io::tfile_support
                         ROOT::Core
-                        ART_ROOT_IO_TFILESERVICE_SERVICE
                         art::Persistency_Common canvas
                         art::Persistency_Provenance canvas
                         art::Utilities canvas
                         messagefacility::MF_MessageLogger
                         cetlib::cetlib cetlib_except
-                        ROOT_BASIC_LIB_LIST
+                        ROOT::Core ROOT::Hist ROOT::Tree
 	  #ProtoDUNEDataUtils
-)
+) ### MIGRATE-ACTION-RECOMMENDED (migrate-3.22.02) - deprecated: use art_make_library(), art_dictonary(), and cet_build_plugin() with explicit source lists and plugin base types
 
 install_headers()
 install_fhicl()
diff --git a/duneprototypes/Protodune/singlephase/CRT/CMakeLists.txt b/duneprototypes/Protodune/singlephase/CRT/CMakeLists.txt
index b3ce6cc..48bf8d9 100644
--- a/duneprototypes/Protodune/singlephase/CRT/CMakeLists.txt
+++ b/duneprototypes/Protodune/singlephase/CRT/CMakeLists.txt
@@ -5,34 +5,33 @@ add_subdirectory(alg)
 cet_add_compiler_flags(CXX -Wno-pedantic)
 
 art_make( MODULE_LIBRARIES
-                        lardataalg_DetectorInfo
-                        lardataobj_RawData
-                        lardataalg_DetectorInfo
-			larcorealg_Geometry
-                        larcorealg_CoreUtils
-			larcore_Geometry_Geometry_service
-                        lardataobj_Simulation
+                        lardataalg::DetectorInfo
+                        lardataobj::RawData
+                        lardataalg::DetectorInfo
+			larcorealg::Geometry
+                        larcorealg::CoreUtils
+			larcore::Geometry_Geometry_service
+                        lardataobj::Simulation
                         nusimdata::SimulationBase
-			lardataobj_RecoBase
-			lardataobj_AnalysisBase
-			larsim_MCCheater_ParticleInventoryService_service
-			larsim_MCCheater_BackTrackerService_service
-			larsim_MCCheater_PhotonBackTrackerService_service
-			ART_FRAMEWORK_CORE
-			ART_FRAMEWORK_PRINCIPAL
-			ART_FRAMEWORK_SERVICES_REGISTRY
-			ART_ROOT_IO_TFILE_SUPPORT
-			ROOT::Core
-			ART_ROOT_IO_TFILESERVICE_SERVICE
+			lardataobj::RecoBase
+			lardataobj::AnalysisBase
+			larsim::MCCheater_ParticleInventoryService_service
+			larsim::MCCheater_BackTrackerService_service
+			larsim::MCCheater_PhotonBackTrackerService_service
+			art::Framework_Core
+			art::Framework_Principal
+		        art_root_io::TFileService_service	
+			art_root_io::tfile_support
+			ROOT::Gpad
  			art::Persistency_Common canvas
 			art::Persistency_Provenance canvas
 			art::Utilities canvas
 			messagefacility::MF_MessageLogger
 			cetlib::cetlib cetlib_except
-			ROOT_BASIC_LIB_LIST
-                        ROOT_GENVECTOR
-                        ROOT_GEOM
-)
+			ROOT::Core ROOT::Hist ROOT::Tree ROOT::Graf
+                        ROOT::GenVector
+                        ROOT::Geom
+) ### MIGRATE-ACTION-RECOMMENDED (migrate-3.22.02) - deprecated: use art_make_library(), art_dictonary(), and cet_build_plugin() with explicit source lists and plugin base types
 
 install_headers()
 install_fhicl()
diff --git a/duneprototypes/Protodune/singlephase/CRT/alg/geom/CMakeLists.txt b/duneprototypes/Protodune/singlephase/CRT/alg/geom/CMakeLists.txt
index 3009299..f91e9ad 100644
--- a/duneprototypes/Protodune/singlephase/CRT/alg/geom/CMakeLists.txt
+++ b/duneprototypes/Protodune/singlephase/CRT/alg/geom/CMakeLists.txt
@@ -1,4 +1,4 @@
-art_make(LIB_LIBRARIES ROOT_BASIC_LIB_LIST)
+art_make(LIB_LIBRARIES ROOT::Core ROOT::Hist ROOT::Tree) ### MIGRATE-ACTION-RECOMMENDED (migrate-3.22.02) - deprecated: use art_make_library(), art_dictonary(), and cet_build_plugin() with explicit source lists and plugin base types
 
 install_headers()
 install_fhicl()
diff --git a/duneprototypes/Protodune/singlephase/CRT/alg/monitor/CMakeLists.txt b/duneprototypes/Protodune/singlephase/CRT/alg/monitor/CMakeLists.txt
index 3009299..f91e9ad 100644
--- a/duneprototypes/Protodune/singlephase/CRT/alg/monitor/CMakeLists.txt
+++ b/duneprototypes/Protodune/singlephase/CRT/alg/monitor/CMakeLists.txt
@@ -1,4 +1,4 @@
-art_make(LIB_LIBRARIES ROOT_BASIC_LIB_LIST)
+art_make(LIB_LIBRARIES ROOT::Core ROOT::Hist ROOT::Tree) ### MIGRATE-ACTION-RECOMMENDED (migrate-3.22.02) - deprecated: use art_make_library(), art_dictonary(), and cet_build_plugin() with explicit source lists and plugin base types
 
 install_headers()
 install_fhicl()
diff --git a/duneprototypes/Protodune/singlephase/CRT/alg/plot/CMakeLists.txt b/duneprototypes/Protodune/singlephase/CRT/alg/plot/CMakeLists.txt
index 6cb12d9..a63beb7 100644
--- a/duneprototypes/Protodune/singlephase/CRT/alg/plot/CMakeLists.txt
+++ b/duneprototypes/Protodune/singlephase/CRT/alg/plot/CMakeLists.txt
@@ -1,5 +1,5 @@
 
-art_make(LIB_LIBRARIES ROOT_BASIC_LIB_LIST )
+art_make(LIB_LIBRARIES ROOT_BASIC_LIB_LIST ) ### MIGRATE-ACTION-RECOMMENDED (migrate-3.22.02) - deprecated: use art_make_library(), art_dictonary(), and cet_build_plugin() with explicit source lists and plugin base types
 
 install_headers()
 install_source()
diff --git a/duneprototypes/Protodune/singlephase/CRT/alg/toROOT/CMakeLists.txt b/duneprototypes/Protodune/singlephase/CRT/alg/toROOT/CMakeLists.txt
index 385f496..1ba0e31 100644
--- a/duneprototypes/Protodune/singlephase/CRT/alg/toROOT/CMakeLists.txt
+++ b/duneprototypes/Protodune/singlephase/CRT/alg/toROOT/CMakeLists.txt
@@ -1,6 +1,6 @@
 
 
-art_make(LIB_LIBRARIES ROOT_BASIC_LIB_LIST )
+art_make(LIB_LIBRARIES ROOT_BASIC_LIB_LIST ) ### MIGRATE-ACTION-RECOMMENDED (migrate-3.22.02) - deprecated: use art_make_library(), art_dictonary(), and cet_build_plugin() with explicit source lists and plugin base types
 
 install_headers()
 install_source()
diff --git a/duneprototypes/Protodune/singlephase/CRT/alg/util/CMakeLists.txt b/duneprototypes/Protodune/singlephase/CRT/alg/util/CMakeLists.txt
index 3009299..f91e9ad 100644
--- a/duneprototypes/Protodune/singlephase/CRT/alg/util/CMakeLists.txt
+++ b/duneprototypes/Protodune/singlephase/CRT/alg/util/CMakeLists.txt
@@ -1,4 +1,4 @@
-art_make(LIB_LIBRARIES ROOT_BASIC_LIB_LIST)
+art_make(LIB_LIBRARIES ROOT::Core ROOT::Hist ROOT::Tree) ### MIGRATE-ACTION-RECOMMENDED (migrate-3.22.02) - deprecated: use art_make_library(), art_dictonary(), and cet_build_plugin() with explicit source lists and plugin base types
 
 install_headers()
 install_fhicl()
diff --git a/duneprototypes/Protodune/singlephase/CRT/data/CMakeLists.txt b/duneprototypes/Protodune/singlephase/CRT/data/CMakeLists.txt
index c14e954..2df305f 100644
--- a/duneprototypes/Protodune/singlephase/CRT/data/CMakeLists.txt
+++ b/duneprototypes/Protodune/singlephase/CRT/data/CMakeLists.txt
@@ -1,4 +1,4 @@
-include_directories( ${CMAKE_CURRENT_SOURCE_DIR} )
+include_directories( ${CMAKE_CURRENT_SOURCE_DIR} ) ### MIGRATE-ACTION-RECOMMENDED (migrate-3.22.02) - avoid directory-scope functions: use target_link_libraries() with target semantics or target_include_directories() whenever possible
 
 art_make( LIB_LIBRARIES
                         lardataobj_Simulation
@@ -14,7 +14,7 @@ art_make( LIB_LIBRARIES
 			cetlib::cetlib cetlib_except
 			lardataobj_AnalysisBase
 			ROOT_BASIC_LIB_LIST
-)
+) ### MIGRATE-ACTION-RECOMMENDED (migrate-3.22.02) - deprecated: use art_make_library(), art_dictonary(), and cet_build_plugin() with explicit source lists and plugin base types
 
 install_headers()
 install_source()
diff --git a/duneprototypes/Protodune/singlephase/CTB/data/CMakeLists.txt b/duneprototypes/Protodune/singlephase/CTB/data/CMakeLists.txt
index b2a8b51..a7fceb5 100644
--- a/duneprototypes/Protodune/singlephase/CTB/data/CMakeLists.txt
+++ b/duneprototypes/Protodune/singlephase/CTB/data/CMakeLists.txt
@@ -1,4 +1,4 @@
-include_directories( ${CMAKE_CURRENT_SOURCE_DIR} )
+include_directories( ${CMAKE_CURRENT_SOURCE_DIR} ) ### MIGRATE-ACTION-RECOMMENDED (migrate-3.22.02) - avoid directory-scope functions: use target_link_libraries() with target semantics or target_include_directories() whenever possible
 
 art_make( LIB_LIBRARIES
                         lardataobj_Simulation
@@ -13,7 +13,7 @@ art_make( LIB_LIBRARIES
 			art::Utilities canvas
 			cetlib::cetlib cetlib_except
 			ROOT_BASIC_LIB_LIST
-)
+) ### MIGRATE-ACTION-RECOMMENDED (migrate-3.22.02) - deprecated: use art_make_library(), art_dictonary(), and cet_build_plugin() with explicit source lists and plugin base types
 
 install_headers()
 install_source()
diff --git a/duneprototypes/Protodune/singlephase/DataUtils/CMakeLists.txt b/duneprototypes/Protodune/singlephase/DataUtils/CMakeLists.txt
index 3acbae4..4c1baba 100644
--- a/duneprototypes/Protodune/singlephase/DataUtils/CMakeLists.txt
+++ b/duneprototypes/Protodune/singlephase/DataUtils/CMakeLists.txt
@@ -22,22 +22,21 @@ art_make( LIBRARY_NAME ProtoDUNEDataUtils
                         larsim_MCCheater_ParticleInventoryService_service
                         nug4::ParticleNavigation 
                         nusimdata::SimulationBase
-                        ART_FRAMEWORK_CORE
-                        ART_FRAMEWORK_PRINCIPAL
-                        ART_FRAMEWORK_SERVICES_REGISTRY
-                        ART_ROOT_IO_TFILE_SUPPORT
+                        art::Framework_Core
+                        art::Framework_Principal
+                        art::Framework_Services_Registry
+                        art_root_io::tfile_support
                         ROOT::Core
-                        ART_ROOT_IO_TFILESERVICE_SERVICE
                         art::Persistency_Common canvas
                         art::Persistency_Provenance canvas
                         art::Utilities canvas
                         messagefacility::MF_MessageLogger
                         fhiclcpp::fhiclcpp
                         cetlib::cetlib cetlib_except
-                        ROOT_BASIC_LIB_LIST
+                        ROOT::Core ROOT::Hist ROOT::Tree
 	  MODULE_LIBRARIES
 	  ProtoDUNEDataUtils
-)
+) ### MIGRATE-ACTION-RECOMMENDED (migrate-3.22.02) - deprecated: use art_make_library(), art_dictonary(), and cet_build_plugin() with explicit source lists and plugin base types
 
 install_headers()
 install_fhicl()
diff --git a/duneprototypes/Protodune/singlephase/DetectorServices/Providers/CMakeLists.txt b/duneprototypes/Protodune/singlephase/DetectorServices/Providers/CMakeLists.txt
index 1712b02..f20685f 100644
--- a/duneprototypes/Protodune/singlephase/DetectorServices/Providers/CMakeLists.txt
+++ b/duneprototypes/Protodune/singlephase/DetectorServices/Providers/CMakeLists.txt
@@ -3,22 +3,22 @@ art_make( NO_PLUGINS
           LIBRARY_NAME  ProtoDUNEspDataProviders
           LIB_LIBRARIES
                         lardataalg_DetectorInfo
-  	                wda
+  	                wda::wda
 	                nuevdb::IFDatabase
                         larcorealg_Geometry
                         art_Framework_Core
                         art::Framework_Principal
-                        ART_ROOT_IO_ROOTDB
+                        art_root_io::RootDB
                         art::Utilities
                         messagefacility::MF_MessageLogger
-                        ART_FRAMEWORK_SERVICES_REGISTRY
+                        art::Framework_Services_Registry
                         cetlib::cetlib cetlib_except
                         canvas::canvas
                         ifdh::ifdh
                         fhiclcpp::fhiclcpp
-                        ROOT_BASIC_LIB_LIST
+                        ROOT::Core ROOT::Hist ROOT::Tree
                         
-        )
+        ) ### MIGRATE-ACTION-RECOMMENDED (migrate-3.22.02) - deprecated: use art_make_library(), art_dictonary(), and cet_build_plugin() with explicit source lists and plugin base types
 
 
 install_headers()
diff --git a/duneprototypes/Protodune/singlephase/DetectorServices/Services/CMakeLists.txt b/duneprototypes/Protodune/singlephase/DetectorServices/Services/CMakeLists.txt
index bedaa86..ba7826d 100644
--- a/duneprototypes/Protodune/singlephase/DetectorServices/Services/CMakeLists.txt
+++ b/duneprototypes/Protodune/singlephase/DetectorServices/Services/CMakeLists.txt
@@ -5,14 +5,14 @@ cet_build_plugin(DetectorPropertiesServiceProtoDUNEsp art::service
               larcorealg_Geometry
               art::Framework_Principal
               ifdh::ifdh
-	      ART_ROOT_IO_ROOTDB
-	      ART_FRAMEWORK_SERVICES_REGISTRY
+	      art_root_io::RootDB
+	      art::Framework_Services_Registry
 	      art::Utilities
 	      canvas::canvas
-	      SQLITE3
+	      SQLite::SQLite3
 	      messagefacility::MF_MessageLogger
 	      cetlib::cetlib cetlib_except
-	      ROOT_BASIC_LIB_LIST
+	      ROOT::Core ROOT::Hist ROOT::Tree
               
 )
 
diff --git a/duneprototypes/Protodune/singlephase/Exe/CMakeLists.txt b/duneprototypes/Protodune/singlephase/Exe/CMakeLists.txt
index f8cbf06..8b8b25b 100644
--- a/duneprototypes/Protodune/singlephase/Exe/CMakeLists.txt
+++ b/duneprototypes/Protodune/singlephase/Exe/CMakeLists.txt
@@ -9,10 +9,10 @@ cet_make_exec(pdChannelRange
   SOURCE pdChannelRange.cxx
   LIBRARIES
     dunecore_ArtSupport
-    ART_FRAMEWORK_CORE
+    art::Framework_Core
     art::Utilities
     art::Persistency_Common
-    fhiclcpp
+    fhiclcpp::fhiclcpp
     canvas::canvas
     cetlib::cetlib 
     cetlib_except::cetlib_except
diff --git a/duneprototypes/Protodune/singlephase/NearlineMonitor/CMakeLists.txt b/duneprototypes/Protodune/singlephase/NearlineMonitor/CMakeLists.txt
index 664bbfc..ffd45b9 100644
--- a/duneprototypes/Protodune/singlephase/NearlineMonitor/CMakeLists.txt
+++ b/duneprototypes/Protodune/singlephase/NearlineMonitor/CMakeLists.txt
@@ -1,26 +1,24 @@
 cet_build_plugin(SPLifetime art::module
-              lardataobj_RecoBase
-              larcorealg_Geometry
-              larcore_Geometry_Geometry_service
-              larsim_MCCheater_BackTrackerService_service
-              larsim_MCCheater_ParticleInventoryService_service
+              lardataobj::RecoBase
+              larcorealg::Geometry
+              larcore::Geometry_Geometry_service
+              larsim::MCCheater_BackTrackerService_service
+              larsim::MCCheater_ParticleInventoryService_service
               nusimdata::SimulationBase
-              ART_FRAMEWORK_CORE
-              ART_FRAMEWORK_PRINCIPAL
-              ART_FRAMEWORK_SERVICES_REGISTRY
-              ART_ROOT_IO_TFILE_SUPPORT
-              ROOT::Core
-              ART_ROOT_IO_TFILESERVICE_SERVICE
-              ART_PERSISTENCY_PROVENANCE
+              art::Framework_Core
+              art::Framework_Principal
+              art::Framework_Services_Registry
+              art_root_io::tfile_support
+	      ROOT::Core ROOT::Graf ROOT::Gpad
+              art::Persistency_Provenance
               art::Persistency_Common
               art::Utilities
               canvas::canvas
               messagefacility::MF_MessageLogger
               cetlib::cetlib cetlib_except
-              ROOT_MATHCORE
-              ROOT_GENVECTOR
-              ROOT_GEOM
-              ROOT_BASIC_LIB_LIST
+              ROOT::MathCore
+              ROOT::GenVector
+              ROOT::Geom
               BASENAME_ONLY)
 
 cet_build_plugin(PlotTrackT0 art::module
@@ -30,22 +28,20 @@ cet_build_plugin(PlotTrackT0 art::module
               larsim_MCCheater_BackTrackerService_service
               larsim_MCCheater_ParticleInventoryService_service
               nusimdata::SimulationBase
-              ART_FRAMEWORK_CORE
-              ART_FRAMEWORK_PRINCIPAL
-              ART_FRAMEWORK_SERVICES_REGISTRY
-              ART_ROOT_IO_TFILE_SUPPORT
+              art::Framework_Core
+              art::Framework_Principal
+              art_root_io::tfile_support
               ROOT::Core
-              ART_ROOT_IO_TFILESERVICE_SERVICE
-              ART_PERSISTENCY_PROVENANCE
+              art::Persistency_Provenance
               art::Persistency_Common
               art::Utilities
               canvas::canvas
               messagefacility::MF_MessageLogger
               cetlib::cetlib cetlib_except
-              ROOT_MATHCORE
-              ROOT_GENVECTOR
-              ROOT_GEOM
-              ROOT_BASIC_LIB_LIST
+              ROOT::MathCore
+              ROOT::GenVector
+              ROOT::Geom
+              ROOT::Core ROOT::Hist ROOT::Tree
               BASENAME_ONLY)
 
 cet_build_plugin(PlotTrackDetails art::module
@@ -55,22 +51,20 @@ cet_build_plugin(PlotTrackDetails art::module
               larsim_MCCheater_BackTrackerService_service
               larsim_MCCheater_ParticleInventoryService_service
               nusimdata::SimulationBase
-              ART_FRAMEWORK_CORE
-              ART_FRAMEWORK_PRINCIPAL
-              ART_FRAMEWORK_SERVICES_REGISTRY
-              ART_ROOT_IO_TFILE_SUPPORT
+              art::Framework_Core
+              art::Framework_Principal
+              art_root_io::tfile_support
               ROOT::Core
-              ART_ROOT_IO_TFILESERVICE_SERVICE
-              ART_PERSISTENCY_PROVENANCE
+              art::Persistency_Provenance
               art::Persistency_Common
               art::Utilities
               canvas::canvas
               messagefacility::MF_MessageLogger
               cetlib::cetlib cetlib_except
-              ROOT_MATHCORE
-              ROOT_GENVECTOR
-              ROOT_GEOM
-              ROOT_BASIC_LIB_LIST
+              ROOT::MathCore
+              ROOT::GenVector
+              ROOT::Geom
+              ROOT::Core ROOT::Hist ROOT::Tree
               BASENAME_ONLY)
 
 cet_build_plugin(PlotEventDetails art::module
@@ -78,45 +72,41 @@ cet_build_plugin(PlotEventDetails art::module
       larcorealg_Geometry
       larcore_Geometry_Geometry_service
       larsim_MCCheater_BackTrackerService_service
-           larsim_MCCheater_ParticleInventoryService_service
+      larsim_MCCheater_ParticleInventoryService_service
       nusimdata::SimulationBase
-      ART_FRAMEWORK_CORE
-      ART_FRAMEWORK_PRINCIPAL
-      ART_FRAMEWORK_SERVICES_REGISTRY
-      ART_ROOT_IO_TFILE_SUPPORT
+      art::Framework_Core
+      art::Framework_Principal
+      art_root_io::tfile_support
       ROOT::Core
-      ART_ROOT_IO_TFILESERVICE_SERVICE
-      ART_PERSISTENCY_PROVENANCE
+      art::Persistency_Provenance
       art::Persistency_Common
       art::Utilities 
       canvas::canvas
       messagefacility::MF_MessageLogger
       cetlib::cetlib cetlib_except
-      ROOT_MATHCORE
-      ROOT_GENVECTOR
-      ROOT_GEOM
-      ROOT_BASIC_LIB_LIST
+      ROOT::MathCore
+      ROOT::GenVector
+      ROOT::Geom
+      ROOT::Core ROOT::Hist ROOT::Tree
       BASENAME_ONLY
 )
 
 cet_build_plugin(PlotOpticalDetails art::module
               lardataobj_RecoBase
-              ART_FRAMEWORK_CORE
-              ART_FRAMEWORK_PRINCIPAL
-              ART_FRAMEWORK_SERVICES_REGISTRY
-              ART_ROOT_IO_TFILE_SUPPORT
+              art::Framework_Core
+              art::Framework_Principal
+              art_root_io::tfile_support
               ROOT::Core
-              ART_ROOT_IO_TFILESERVICE_SERVICE
-              ART_PERSISTENCY_PROVENANCE
+              art::Persistency_Provenance
               art::Persistency_Common
               art::Utilities
               canvas::canvas
               messagefacility::MF_MessageLogger
               cetlib::cetlib cetlib_except
-              ROOT_MATHCORE
-              ROOT_GENVECTOR
-              ROOT_GEOM
-              ROOT_BASIC_LIB_LIST
+              ROOT::MathCore
+              ROOT::GenVector
+              ROOT::Geom
+              ROOT::Core ROOT::Hist ROOT::Tree
               BASENAME_ONLY)
 
 cet_build_plugin(RawEventDisplay art::module
@@ -125,15 +115,13 @@ cet_build_plugin(RawEventDisplay art::module
               lardataalg_DetectorInfo
               lardataobj_RawData
               nusimdata::SimulationBase
-              ART_FRAMEWORK_CORE
-              ART_FRAMEWORK_PRINCIPAL
-              ART_FRAMEWORK_SERVICES_REGISTRY
-              ART_ROOT_IO_TFILE_SUPPORT
+              art::Framework_Core
+              art::Framework_Principal
+              art_root_io::tfile_support
               ROOT::Core
-              ART_ROOT_IO_TFILESERVICE_SERVICE
               messagefacility::MF_MessageLogger
-              CETLIB
-              ROOT_BASIC_LIB_LIST
+              cetlib::cetlib
+              ROOT::Core ROOT::Hist ROOT::Tree
               BASENAME_ONLY)
 
 cet_build_plugin(TpcMonitor art::module
@@ -143,16 +131,14 @@ cet_build_plugin(TpcMonitor art::module
               lardataobj_RawData
               nusimdata::SimulationBase
               dunepdlegacy_Services_ChannelMap_PdspChannelMapService_service
-              ART_FRAMEWORK_CORE
-              ART_FRAMEWORK_PRINCIPAL
-              ART_FRAMEWORK_SERVICES_REGISTRY
-              ART_ROOT_IO_TFILE_SUPPORT
+              art::Framework_Core
+              art::Framework_Principal
+              art_root_io::tfile_support
               ROOT::Core
-              ART_ROOT_IO_TFILESERVICE_SERVICE
-              ART_PERSISTENCY_PROVENANCE
+              art::Persistency_Provenance
               messagefacility::MF_MessageLogger
-              CETLIB
-              ROOT_BASIC_LIB_LIST
+              cetlib::cetlib
+              ROOT::Core ROOT::Hist ROOT::Tree
               BASENAME_ONLY)
 
 cet_build_plugin(SSPMonitor art::module
@@ -161,32 +147,28 @@ cet_build_plugin(SSPMonitor art::module
               lardataobj_RawData
               lardataobj_RecoBase
               nusimdata::SimulationBase
-              ART_FRAMEWORK_CORE
-              ART_FRAMEWORK_PRINCIPAL
-              ART_FRAMEWORK_SERVICES_REGISTRY
-              ART_ROOT_IO_TFILE_SUPPORT
+              art::Framework_Core
+              art::Framework_Principal
+              art_root_io::tfile_support
               ROOT::Core
-              ART_ROOT_IO_TFILESERVICE_SERVICE
-              ART_PERSISTENCY_PROVENANCE
+              art::Persistency_Provenance
               messagefacility::MF_MessageLogger
-              CETLIB
-              ROOT_BASIC_LIB_LIST
+              cetlib::cetlib
+              ROOT::Core ROOT::Hist ROOT::Tree
               BASENAME_ONLY)
 
 cet_build_plugin(PDSPNearlineHeader art::module
               lardataobj_RecoBase
-              ART_FRAMEWORK_CORE
-              ART_FRAMEWORK_PRINCIPAL
-              ART_FRAMEWORK_SERVICES_REGISTRY
-              ART_ROOT_IO_TFILE_SUPPORT
+              art::Framework_Core
+              art::Framework_Principal
+              art_root_io::tfile_support
               ROOT::Core
-              ART_ROOT_IO_TFILESERVICE_SERVICE
               art::Persistency_Common
               art::Utilities
               canvas::canvas
               messagefacility::MF_MessageLogger
               cetlib::cetlib cetlib_except
-              ROOT_BASIC_LIB_LIST
+              ROOT::Core ROOT::Hist ROOT::Tree
               BASENAME_ONLY)
 
 cet_build_plugin(PDSPHitMonitor art::module
@@ -195,16 +177,14 @@ cet_build_plugin(PDSPHitMonitor art::module
               lardataobj_RawData
               nusimdata::SimulationBase
               dunepdlegacy_Services_ChannelMap_PdspChannelMapService_service
-              ART_FRAMEWORK_CORE
-              ART_FRAMEWORK_PRINCIPAL
-              ART_FRAMEWORK_SERVICES_REGISTRY
-              ART_ROOT_IO_TFILE_SUPPORT
+              art::Framework_Core
+              art::Framework_Principal
+              art_root_io::tfile_support
               ROOT::Core
-              ART_ROOT_IO_TFILESERVICE_SERVICE
-              ART_PERSISTENCY_PROVENANCE
+              art::Persistency_Provenance
               messagefacility::MF_MessageLogger
-              CETLIB
-              ROOT_BASIC_LIB_LIST
+              cetlib::cetlib
+              ROOT::Core ROOT::Hist ROOT::Tree
               BASENAME_ONLY)
 
 install_headers()
diff --git a/duneprototypes/Protodune/singlephase/RawDecoding/CMakeLists.txt b/duneprototypes/Protodune/singlephase/RawDecoding/CMakeLists.txt
index 2667f0d..c4e1325 100644
--- a/duneprototypes/Protodune/singlephase/RawDecoding/CMakeLists.txt
+++ b/duneprototypes/Protodune/singlephase/RawDecoding/CMakeLists.txt
@@ -1,6 +1,5 @@
 
 cet_build_plugin(PDSPTPCDataInterface   art::tool
-				     art_utilities
 				     canvas::canvas
 				     cetlib::cetlib
 				     cetlib_except::cetlib_except
@@ -15,10 +14,9 @@ cet_build_plugin(PDSPTPCDataInterface   art::tool
                         art_root_io::tfile_support
                         ROOT::Core
                         art_root_io::TFileService_service
-                        ART_PERSISTENCY_PROVENANCE
+                        art::Persistency_Provenance
                         messagefacility::MF_MessageLogger
-                        CETLIB
-                        ROOT_BASIC_LIB_LIST
+                        ROOT::Core ROOT::Hist ROOT::Tree
                         dunepdlegacy::rce_dataaccess
                         z
              )
@@ -35,10 +33,9 @@ cet_build_plugin(TimingRawDecoder art::module
                         art_root_io::tfile_support
                         ROOT::Core
                         art_root_io::TFileService_service
-                        ART_PERSISTENCY_PROVENANCE
+                        art::Persistency_Provenance
                         messagefacility::MF_MessageLogger
-                        CETLIB
-                        ROOT_BASIC_LIB_LIST
+                        ROOT::Core ROOT::Hist ROOT::Tree
                         BASENAME_ONLY
 )
 
@@ -55,10 +52,9 @@ cet_build_plugin(SSPRawDecoder art::module
                         art_root_io::tfile_support
                         ROOT::Core
                         art_root_io::TFileService_service
-                        ART_PERSISTENCY_PROVENANCE
+                        art::Persistency_Provenance
                         messagefacility::MF_MessageLogger
-                        CETLIB
-                        ROOT_BASIC_LIB_LIST
+                        ROOT::Core ROOT::Hist ROOT::Tree
                         BASENAME_ONLY
 )
 
@@ -78,8 +74,7 @@ cet_build_plugin(PDWaveform art::module
                          art_root_io::TFileService_service
                          messagefacility::MF_MessageLogger
 			 dunecore_Geometry
-			 CETLIB
-                         ROOT_BASIC_LIB_LIST
+                         ROOT::Core ROOT::Hist ROOT::Tree
 			 ROOT_SPECTRUM
                          BASENAME_ONLY
 )
@@ -98,10 +93,9 @@ cet_build_plugin(RceRawDecoder art::module
                         art_root_io::tfile_support
                         ROOT::Core
                         art_root_io::TFileService_service
-                        ART_PERSISTENCY_PROVENANCE
+                        art::Persistency_Provenance
                         messagefacility::MF_MessageLogger
-                        CETLIB
-                        ROOT_BASIC_LIB_LIST
+                        ROOT::Core ROOT::Hist ROOT::Tree
                         dunepdlegacy::rce_dataaccess
                         BASENAME_ONLY
 )
@@ -119,10 +113,9 @@ cet_build_plugin(FelixRawDecoder art::module
                         art_root_io::tfile_support
                         ROOT::Core
                         art_root_io::TFileService_service
-                        ART_PERSISTENCY_PROVENANCE
+                        art::Persistency_Provenance
                         messagefacility::MF_MessageLogger
-                        CETLIB
-                        ROOT_BASIC_LIB_LIST
+                        ROOT::Core ROOT::Hist ROOT::Tree
                         dunepdlegacy::rce_dataaccess
                         z
                         BASENAME_ONLY
@@ -141,10 +134,9 @@ cet_build_plugin(FelixIntegrityTest art::module
                         art_root_io::tfile_support
                         ROOT::Core
                         art_root_io::TFileService_service
-                        ART_PERSISTENCY_PROVENANCE
+                        art::Persistency_Provenance
                         messagefacility::MF_MessageLogger
-                        CETLIB
-                        ROOT_BASIC_LIB_LIST
+                        ROOT::Core ROOT::Hist ROOT::Tree
                         dunepdlegacy::rce_dataaccess
                         z
                         BASENAME_ONLY
@@ -162,10 +154,9 @@ cet_build_plugin(PDSPTPCRawDecoder art::module
                         art_root_io::tfile_support
                         ROOT::Core
                         art_root_io::TFileService_service
-                        ART_PERSISTENCY_PROVENANCE
+                        art::Persistency_Provenance
                         messagefacility::MF_MessageLogger
-                        CETLIB
-                        ROOT_BASIC_LIB_LIST
+                        ROOT::Core ROOT::Hist ROOT::Tree
                         dunepdlegacy::rce_dataaccess
                         z
                         BASENAME_ONLY
@@ -182,10 +173,9 @@ cet_build_plugin(CRTRawDecoder art::module
                         art_root_io::tfile_support
                         ROOT::Core
                         art_root_io::TFileService_service
-                        ART_PERSISTENCY_PROVENANCE
+                        art::Persistency_Provenance
                         messagefacility::MF_MessageLogger
-                        CETLIB
-                        ROOT_BASIC_LIB_LIST
+                        ROOT::Core ROOT::Hist ROOT::Tree
                         dunepdlegacy::rce_dataaccess
                         BASENAME_ONLY
 )
@@ -200,11 +190,10 @@ cet_build_plugin(PDSPCTBRawDecoder art::module
                         art_root_io::tfile_support
                         ROOT::Core
                         art_root_io::TFileService_service
-                        ART_PERSISTENCY_PROVENANCE
+                        art::Persistency_Provenance
                         messagefacility::MF_MessageLogger
                         messagefacility::MF_MessageLogger
-                        CETLIB
-                        ROOT_BASIC_LIB_LIST
+                        ROOT::Core ROOT::Hist ROOT::Tree
                         dunepdlegacy::rce_dataaccess
                         BASENAME_ONLY
 )
@@ -227,8 +216,7 @@ art_make_library( LIBRARY_NAME dunetpc_protodune_RawDecodingUtils
  #                 art::Persistency_Provenance canvas_Persistency_Provenance
  #                 art::Utilities canvas_Utilities
                   messagefacility::MF_MessageLogger
-                  CETLIB
-                  ROOT_BASIC_LIB_LIST
+                  ROOT::Core ROOT::Hist ROOT::Tree
                   dunepdlegacy::rce_dataaccess
 )
 
diff --git a/duneprototypes/Protodune/singlephase/T0Reco/CMakeLists.txt b/duneprototypes/Protodune/singlephase/T0Reco/CMakeLists.txt
index 20b1b1a..f5c5579 100644
--- a/duneprototypes/Protodune/singlephase/T0Reco/CMakeLists.txt
+++ b/duneprototypes/Protodune/singlephase/T0Reco/CMakeLists.txt
@@ -11,21 +11,20 @@ art_make( BASENAME_ONLY
                            larsim_MCCheater_BackTrackerService_service
                            larsim_MCCheater_ParticleInventoryService_service
                            nusimdata::SimulationBase
-                           ART_FRAMEWORK_CORE
-                           ART_FRAMEWORK_PRINCIPAL
-                           ART_FRAMEWORK_SERVICES_REGISTRY
-                           ART_ROOT_IO_TFILE_SUPPORT
+                           art::Framework_Core
+                           art::Framework_Principal
+                           art::Framework_Services_Registry
+                           art_root_io::tfile_support
 			   ROOT::Core
-                           ART_ROOT_IO_TFILESERVICE_SERVICE
-                           ART_PERSISTENCY_PROVENANCE
+                           art::Persistency_Provenance
                            art::Persistency_Common
                            art::Utilities canvas
                            messagefacility::MF_MessageLogger
                            fhiclcpp::fhiclcpp
                            cetlib::cetlib cetlib_except
-                           ROOT_BASIC_LIB_LIST
+                           ROOT::Core ROOT::Hist ROOT::Tree
 	   		   #ProtoDUNEDataUtils
-         )
+         ) ### MIGRATE-ACTION-RECOMMENDED (migrate-3.22.02) - deprecated: use art_make_library(), art_dictonary(), and cet_build_plugin() with explicit source lists and plugin base types
 
 install_headers()
 install_fhicl()
diff --git a/duneprototypes/Protodune/singlephase/Tool/CMakeLists.txt b/duneprototypes/Protodune/singlephase/Tool/CMakeLists.txt
index f580ec9..bfec16e 100644
--- a/duneprototypes/Protodune/singlephase/Tool/CMakeLists.txt
+++ b/duneprototypes/Protodune/singlephase/Tool/CMakeLists.txt
@@ -9,58 +9,58 @@ cet_build_plugin(PdspOnlineChannel   art::tool
                 dunepdlegacy_Services_ChannelMap_PdspChannelMapService_service
                 art::Utilities canvas
                 cetlib::cetlib cetlib_except
-                ART_FRAMEWORK_SERVICES_REGISTRY
-                ROOT_BASIC_LIB_LIST
+                art::Framework_Services_Registry
+                ROOT::Core ROOT::Hist ROOT::Tree
              )
 
 cet_build_plugin(IcebergOnlineChannel   art::tool
                 dunepdlegacy_Services_ChannelMap_IcebergChannelMapService_service
                 art::Utilities canvas
                 cetlib::cetlib cetlib_except
-                ART_FRAMEWORK_SERVICES_REGISTRY
-                ROOT_BASIC_LIB_LIST
+                art::Framework_Services_Registry
+                ROOT::Core ROOT::Hist ROOT::Tree
              )
 
 cet_build_plugin(ProtoduneOnlineChannel   art::tool
                 art::Utilities canvas
                 cetlib::cetlib cetlib_except
-                ART_FRAMEWORK_SERVICES_REGISTRY
-                ROOT_BASIC_LIB_LIST
+                art::Framework_Services_Registry
+                ROOT::Core ROOT::Hist ROOT::Tree
              )
 
 cet_build_plugin(ProtoDuneChannelRanges  art::tool
                 dunecore_ArtSupport
                 art::Utilities canvas
                 cetlib::cetlib cetlib_except
-                ROOT_BASIC_LIB_LIST
+                ROOT::Core ROOT::Hist ROOT::Tree
              )
 
 cet_build_plugin(ApaChannelRanges  art::tool
                 dunecore_ArtSupport
                 art::Utilities canvas
                 cetlib::cetlib cetlib_except
-                ROOT_BASIC_LIB_LIST
+                ROOT::Core ROOT::Hist ROOT::Tree
              )
 
 cet_build_plugin(HalfApaChannelRanges  art::tool
                 dunecore_ArtSupport
                 art::Utilities canvas
                 cetlib::cetlib cetlib_except
-                ROOT_BASIC_LIB_LIST
+                ROOT::Core ROOT::Hist ROOT::Tree
              )
 
 cet_build_plugin(ProtoDuneChannelGroups  art::tool
                 dunecore_ArtSupport
                 art::Utilities canvas
                 cetlib::cetlib cetlib_except
-                ROOT_BASIC_LIB_LIST
+                ROOT::Core ROOT::Hist ROOT::Tree
              )
 
 cet_build_plugin(ApaChannelGroups  art::tool
                 dunecore_ArtSupport
                 art::Utilities canvas
                 cetlib::cetlib cetlib_except
-                ROOT_BASIC_LIB_LIST
+                ROOT::Core ROOT::Hist ROOT::Tree
              )
 
 add_subdirectory(test)
diff --git a/duneprototypes/Protodune/singlephase/Tool/test/CMakeLists.txt b/duneprototypes/Protodune/singlephase/Tool/test/CMakeLists.txt
index 80cfbf3..594c018 100644
--- a/duneprototypes/Protodune/singlephase/Tool/test/CMakeLists.txt
+++ b/duneprototypes/Protodune/singlephase/Tool/test/CMakeLists.txt
@@ -15,8 +15,8 @@ cet_test(test_PdspOnlineChannel SOURCES test_PdspOnlineChannel.cxx
     fhiclcpp
     cetlib::cetlib cetlib_except
     cetlib_except::cetlib_except
-    ROOT_BASIC_LIB_LIST
-    SQLITE3
+    ROOT::Core ROOT::Hist ROOT::Tree
+    SQLite::SQLite3
     Boost::filesystem
 )
 
@@ -28,8 +28,8 @@ cet_test(test_IcebergOnlineChannel SOURCES test_IcebergOnlineChannel.cxx
     fhiclcpp
     cetlib::cetlib cetlib_except
     cetlib_except::cetlib_except
-    ROOT_BASIC_LIB_LIST
-    SQLITE3
+    ROOT::Core ROOT::Hist ROOT::Tree
+    SQLite::SQLite3
     Boost::filesystem
 )
 
@@ -42,8 +42,8 @@ cet_test(test_ProtoduneOnlineChannel SOURCES test_ProtoduneOnlineChannel.cxx
     fhiclcpp
     cetlib::cetlib cetlib_except
     cetlib_except::cetlib_except
-    ROOT_BASIC_LIB_LIST
-    SQLITE3
+    ROOT::Core ROOT::Hist ROOT::Tree
+    SQLite::SQLite3
     Boost::filesystem
 )
 
@@ -55,8 +55,8 @@ cet_test(test_ProtoDuneChannelRanges SOURCES test_ProtoDuneChannelRanges.cxx
     fhiclcpp
     cetlib::cetlib cetlib_except
     cetlib_except::cetlib_except
-    ROOT_BASIC_LIB_LIST
-    SQLITE3
+    ROOT::Core ROOT::Hist ROOT::Tree
+    SQLite::SQLite3
     Boost::filesystem
 )
 
@@ -68,8 +68,8 @@ cet_test(test_ApaChannelRanges SOURCES test_ApaChannelRanges.cxx
     fhiclcpp
     cetlib::cetlib cetlib_except
     cetlib_except::cetlib_except
-    ROOT_BASIC_LIB_LIST
-    SQLITE3
+    ROOT::Core ROOT::Hist ROOT::Tree
+    SQLite::SQLite3
     Boost::filesystem
 )
 
@@ -81,8 +81,8 @@ cet_test(test_HalfApaChannelRanges SOURCES test_HalfApaChannelRanges.cxx
     fhiclcpp
     cetlib::cetlib cetlib_except
     cetlib_except::cetlib_except
-    ROOT_BASIC_LIB_LIST
-    SQLITE3
+    ROOT::Core ROOT::Hist ROOT::Tree
+    SQLite::SQLite3
     Boost::filesystem
 )
 
@@ -94,8 +94,8 @@ cet_test(test_ProtoDuneChannelGroups SOURCES test_ProtoDuneChannelGroups.cxx
     fhiclcpp
     cetlib::cetlib cetlib_except
     cetlib_except::cetlib_except
-    ROOT_BASIC_LIB_LIST
-    SQLITE3
+    ROOT::Core ROOT::Hist ROOT::Tree
+    SQLite::SQLite3
     Boost::filesystem
 )
 
@@ -107,8 +107,8 @@ cet_test(test_ApaChannelGroups SOURCES test_ApaChannelGroups.cxx
     fhiclcpp
     cetlib::cetlib cetlib_except
     cetlib_except::cetlib_except
-    ROOT_BASIC_LIB_LIST
-    SQLITE3
+    ROOT::Core ROOT::Hist ROOT::Tree
+    SQLite::SQLite3
     Boost::filesystem
 )
 
diff --git a/duneprototypes/Protodune/singlephase/Utility/CMakeLists.txt b/duneprototypes/Protodune/singlephase/Utility/CMakeLists.txt
index f42a249..6208e01 100644
--- a/duneprototypes/Protodune/singlephase/Utility/CMakeLists.txt
+++ b/duneprototypes/Protodune/singlephase/Utility/CMakeLists.txt
@@ -7,9 +7,9 @@ art_make(BASENAME_ONLY
          art::Utilities
          canvas::canvas
          cetlib::cetlib
-         ROOT_BASIC_LIB_LIST
+         ROOT::Core ROOT::Hist ROOT::Tree
          NO_PLUGINS
-        )
+        ) ### MIGRATE-ACTION-RECOMMENDED (migrate-3.22.02) - deprecated: use art_make_library(), art_dictonary(), and cet_build_plugin() with explicit source lists and plugin base types
 
 # Install the Root dictionary in the build and product lib directories.
 #install(FILES TickModTreeData_Dict_rdict.pcm DESTINATION ${CMAKE_LIBRARY_OUTPUT_DIRECTORY})
diff --git a/duneprototypes/Protodune/singlephase/Utility/test/CMakeLists.txt b/duneprototypes/Protodune/singlephase/Utility/test/CMakeLists.txt
index a536813..e014cc8 100644
--- a/duneprototypes/Protodune/singlephase/Utility/test/CMakeLists.txt
+++ b/duneprototypes/Protodune/singlephase/Utility/test/CMakeLists.txt
@@ -14,8 +14,8 @@ cet_test(test_ProtoduneChannelHelper SOURCES test_ProtoduneChannelHelper.cxx
     fhiclcpp
     cetlib::cetlib cetlib_except
     cetlib_except::cetlib_except
-    SQLITE3
+    SQLite::SQLite3
     Boost::filesystem
-    ROOT_BASIC_LIB_LIST
+    ROOT::Core ROOT::Hist ROOT::Tree
 )
 
diff --git a/duneprototypes/Protodune/singlephase/dEdxcalibration/CMakeLists.txt b/duneprototypes/Protodune/singlephase/dEdxcalibration/CMakeLists.txt
index 551a46d..e8b671c 100644
--- a/duneprototypes/Protodune/singlephase/dEdxcalibration/CMakeLists.txt
+++ b/duneprototypes/Protodune/singlephase/dEdxcalibration/CMakeLists.txt
@@ -1,87 +1,81 @@
-
 # temporary fix for an extra semicolon in the root v6_22_06a TVirtualPaveStats header
 cet_add_compiler_flags(CXX -Wno-pedantic)
 
 art_make( 
   LIB_LIBRARIES 
-  lardataobj_RecoBase
+  lardataobj::RecoBase
   larana_OpticalDetector_OpHitFinder
-  larsim_MCSTReco
-  lardataobj_MCBase
-  larcorealg_Geometry
-  larcore_Geometry_Geometry_service
-  larsim_PhotonPropagation_PhotonVisibilityService_service
+  larsim::MCSTReco
+  lardataobj::MCBase
+  larcorealg::Geometry
+  larcore::Geometry_Geometry_service
+  larsim::PhotonPropagation_PhotonVisibilityService_service
   larana_OpticalDetector_OpDigiProperties_service
-  lardata_Utilities
+  lardata::Utilities
   nusimdata::SimulationBase
-  ART_FRAMEWORK_CORE
-  ART_FRAMEWORK_PRINCIPAL
-  ART_FRAMEWORK_SERVICES_REGISTRY
-  ART_ROOT_IO_TFILE_SUPPORT
+  art::Framework_Core
+  art::Framework_Principal
+  art::Framework_Services_Registry
+  art_root_io::tfile_support
   ROOT::Core
-  ART_ROOT_IO_TFILESERVICE_SERVICE
-  ART_FRAMEWORK_SERVICES_OPTIONAL_RANDOMNUMBERGENERATOR_SERVICE
   art::Persistency_Common
   art::Utilities
   canvas::canvas
   messagefacility::MF_MessageLogger
   fhiclcpp::fhiclcpp
   cetlib::cetlib cetlib_except
-  ROOT_BASIC_LIB_LIST
+  ROOT::Core ROOT::Hist ROOT::Tree
   MODULE_LIBRARIES larana_OpticalDetector_OpDigiProperties_service
   larana_OpticalDetector_OpHitFinder
   larana_OpticalDetector
-  larsim_PhotonPropagation_PhotonVisibilityService_service
-  larsim_MCCheater_BackTrackerService_service
-  larsim_MCCheater_ParticleInventoryService_service
-  larevt_Filters
+  larsim::PhotonPropagation_PhotonVisibilityService_service
+  larsim::MCCheater_BackTrackerService_service
+  larsim::MCCheater_ParticleInventoryService_service
+  larevt::Filters
   lardataalg_DetectorInfo
-  lardata_RecoObjects
-  lardataobj_RecoBase
-  lardataobj_MCBase
+  lardata::RecoObjects
+  lardataobj::RecoBase
+  lardataobj::MCBase
   larreco_RecoAlg
-  larcorealg_Geometry
-  larcore_Geometry_Geometry_service
-  larsim_Simulation nug4::ParticleNavigation lardataobj_Simulation
-  lardata_Utilities
-  lardataobj_RawData
+  larcorealg::Geometry
+  larcore::Geometry_Geometry_service
+  larsim::Simulation nug4::ParticleNavigation lardataobj::Simulation
+  lardata::Utilities
+  lardataobj::RawData
   larreco_Calorimetry
-  lardataobj_AnalysisBase
+  lardataobj::AnalysisBase
   nurandom::RandomUtils_NuRandomService_service
   nusimdata::SimulationBase
-  ART_FRAMEWORK_CORE
-  ART_FRAMEWORK_PRINCIPAL
-  ART_FRAMEWORK_SERVICES_REGISTRY
-  ART_ROOT_IO_TFILE_SUPPORT
+  art::Framework_Core
+  art::Framework_Principal
+  art::Framework_Services_Registry
+  art_root_io::tfile_support
   ROOT::Core
-  ART_ROOT_IO_TFILESERVICE_SERVICE
-  ART_FRAMEWORK_SERVICES_OPTIONAL_RANDOMNUMBERGENERATOR_SERVICE
-  ART_PERSISTENCY_PROVENANCE
+  art::Persistency_Provenance
   art::Persistency_Common
   art::Utilities
   canvas::canvas
   messagefacility::MF_MessageLogger
   fhiclcpp::fhiclcpp
   cetlib::cetlib cetlib_except
-  ROOT_BASIC_LIB_LIST
+  ROOT::Core ROOT::Hist ROOT::Tree
   SERVICE_LIBRARIES
-  larcorealg_Geometry
-  larcore_Geometry_Geometry_service
-  ART_FRAMEWORK_CORE
-  ART_FRAMEWORK_PRINCIPAL
-  ART_FRAMEWORK_SERVICES_REGISTRY
-  ART_ROOT_IO_TFILE_SUPPORT
+  larcorealg::Geometry
+  larcore::Geometry_Geometry_service
+  art::Framework_Core
+  art::Framework_Principal
+  art::Framework_Services_Registry
+  art_root_io::tfile_support
   ROOT::Core
-  ART_ROOT_IO_TFILESERVICE_SERVICE
   art::Persistency_Common
   art::Utilities
   canvas::canvas
   messagefacility::MF_MessageLogger
   fhiclcpp::fhiclcpp
   cetlib::cetlib cetlib_except
-  CLHEP
-  ROOT_BASIC_LIB_LIST
-  )
+  CLHEP::CLHEP
+  ROOT::Core ROOT::Hist ROOT::Tree
+  ) ### MIGRATE-ACTION-RECOMMENDED (migrate-3.22.02) - deprecated: use art_make_library(), art_dictonary(), and cet_build_plugin() with explicit source lists and plugin base types
 
 install_headers()
 install_fhicl()
diff --git a/duneprototypes/Protodune/vd/CRT/CMakeLists.txt b/duneprototypes/Protodune/vd/CRT/CMakeLists.txt
index 16cd9fb..47437af 100644
--- a/duneprototypes/Protodune/vd/CRT/CMakeLists.txt
+++ b/duneprototypes/Protodune/vd/CRT/CMakeLists.txt
@@ -1,21 +1,22 @@
-include_directories( ${CMAKE_CURRENT_SOURCE_DIR} )
+include_directories( ${CMAKE_CURRENT_SOURCE_DIR} ) ### MIGRATE-ACTION-RECOMMENDED (migrate-3.22.02) - avoid directory-scope functions: use target_link_libraries() with target semantics or target_include_directories() whenever possible
 
 art_make( MODULE_LIBRARIES
                         lardataobj_Simulation
                         nusimdata::SimulationBase
-			ART_FRAMEWORK_CORE
-			ART_FRAMEWORK_PRINCIPAL
-			ART_FRAMEWORK_SERVICES_REGISTRY
-			ART_ROOT_IO_TFILE_SUPPORT
+			art::Framework_Core
+			art::Framework_Principal
+			art::Framework_Services_Registry
+			art_root_io::tfile_support
 			ROOT::Core
  			art::Persistency_Common canvas
 			art::Persistency_Provenance canvas
 			art::Utilities canvas
 			cetlib::cetlib cetlib_except
 			lardataobj_AnalysisBase
-			ROOT_BASIC_LIB_LIST
+			larcorealg_Geometry
+			ROOT::Core ROOT::Hist ROOT::Tree
                         larcoreobj_SimpleTypesAndConstants
-)
+) ### MIGRATE-ACTION-RECOMMENDED (migrate-3.22.02) - deprecated: use art_make_library(), art_dictonary(), and cet_build_plugin() with explicit source lists and plugin base types
 
 install_headers()
 install_source()
diff --git a/ups/CMakeLists.txt b/ups/CMakeLists.txt
deleted file mode 100644
index fe33cc7..0000000
--- a/ups/CMakeLists.txt
+++ /dev/null
@@ -1,6 +0,0 @@
-
-# create package configuration and version files
-
-process_ups_files()
-
-cet_cmake_config()
diff --git a/ups/product-config.cmake.in b/ups/product-config.cmake.in
deleted file mode 100644
index 4e22a3b..0000000
--- a/ups/product-config.cmake.in
+++ /dev/null
@@ -1,12 +0,0 @@
-
-set( @product@_VERSION @cet_dot_version@ )
-set( @product@_UPS_VERSION @version@ )
-
-@PACKAGE_INIT@
-
-@CONFIG_FIND_UPS_COMMANDS@
-
-@CONFIG_FIND_LIBRARY_COMMANDS@
-
-check_required_components(@product@)
-
diff --git a/ups/product_deps b/ups/product_deps
index 0c0d69d..3065172 100644
--- a/ups/product_deps
+++ b/ups/product_deps
@@ -1,47 +1,334 @@
-# This @product_deps@ file defines dependencies for this package.
+########################################################################
+# product_deps
+#
+#   Define attributes of a package to be built and distributed as a UPS
+#   product.
+#
+# This file is parsed as a consequence of sourcing the
+# setup_for_development or setup_deps shell-agnostic scripts.
+#
+# Generated by cetmodules 3.22.02 at Wed Sep 13 16:53:29 CDT 2023
+########################################################################
 
-# The *parent* line must the first non-commented line and defines this product and version
-# The version must be of the form vxx_yy_zz (e.g. v01_02_03).
+####################################
+# Basic information.
 
-parent duneprototypes
+##################
+# parent
+##################
+#
+# The parent line - if present - must be the first non-comment line in
+# the file, defining the product's name and version. Any information not
+# specified will be taken from the CMake project(<project-name> VERSION
+# <dot-version>) call in the CMakeLists.txt in the parent directory to
+# the one containing this file.
+#
+# Recommended:
+#
+#>  parent <product-name>
+#
+# Deprecated (will produce a warning):
+#
+#>  parent <product-name> <product-ups-version> [<chain>]...
 
-defaultqual e26
+##################
+# chain[s]
+##################
+#
+# List the UPS chains ("-c", -t, "new," "current," "old...") to be defined
+# for the package. The trailing `s' is optional and without meaning.
+# Multiple chains may be specified with one or more declarations.
+#
+#>  chains <chain>...
 
-# These optional lines define where headers, libraries, and executables go and should
-# be used only if your product does not conform to the defaults.
-# Format: directory_type directory_path directory_name
-#   where directory_type is one of incdir, libdir, or bindir
-#   where directory_path is one of product_dir, fq_dir and -
-# Defaults:
-#incdir  product_dir  include
-#fcldir  product_dir  fcl
-#libdir  fq_dir       lib
-#bindir  fq_dir       bin
+##################
+# defaultqual
+##################
+#
+# The default colon-delimited qualifier set used if one is not provided
+# to setup_for_development. Build type (debug, opt or prof) is optional.
+#
+# Deprecated - a qualifier should generally be provided to the
+# invocation of setup_for_development or setup_deps.
+#
+#>  defaultqual <qualifiers>
 
-fwdir	product_dir	config_data
+##################
+# noarch
+##################
+#
+# Specify this keyword if the package is architecture-independent. This
+# does not necessarily imply a lack of qualifiers or of a
+# fully-qualified (fq) subdirectory in the installed package.
+#
+#>  noarch
+
+##################
+# no_fq_dir
+##################
+#
+# Specify this keyword if the UPS package should not have a
+# fully-qualified (fq) subdirectory in the installed package. This does
+# not necessarily imply noarch or a lack of qualifiers, but caution
+# should be observed if using this keyword for architecture-dependent
+# packages or those with qualifiers to avoid overwritten files when
+# multiple different variants of the package are installed in the same
+# UPS area.
+#
+#>  no_fq_dir
 
-# With "product  version" table below, we now define depdendencies
+##################
+# define_pythonpath
+##################
+#
+# If define_pythonpath is enabled, the appropriate path will be appended
+# to PYTHONPATH.
+#
+#>  define_pythonpath
+####################################
+parent		duneprototypes
+defaultqual	e26
+####################################
 
-# Add the dependent product and version
+####################################
+# Directory specifications.
+#
+# These optional definitions specify the installed directories where
+# various files headers, libraries, and executables will be found. Some
+# have defaults; others must be specified if files of that type are to
+# be installed. Minimize configuration complexity by using only those
+# definitions necessary for the package.
+#
+##################
+# Notes:
+#
+# * Use directory specifications only if the defaults are inappropriate
+#   for your product.
+#
+# * A specification with defaults may be obviated by specifying a base
+#   of `-' as the only argument.
+#
+# * A directory will be created and appropriate UPS table file entries
+#   made *if and only if* files of that type are installed using the
+#   appropriate directive.
+#
+##################
+# Format:
+#
+#>  <spec>		<base>		[<subdir-name>]
+#
+# <base> may be `-' (negate defaults), "product_dir", or "fq_dir" as
+# desired.
+#
+# Available <spec>s and defaults:
+#
+#>  bindir		fq_dir		bin
+#
+#     Built binaries for public use.
+#
+#>  cmakemoduledir	product_dir	Modules
+#
+#     CMake modules.
+#
+#>  fcldir		product_dir	fcl
+#
+#     FHiCL framework configuration files.
+#
+#>  fwdir
+#
+#     Framework data.
+#
+#>  gdmldir		product_dir	gdml
+#
+#     GDML geometry description files.
+#
+#>  incdir		product_dir	include
+#
+#     Headers.
+#
+#>  libdir		fq_dir		lib
+#
+#     Compiled and other libraries.
+#
+#>  perllib		product_dir	perl5lib
+#
+#     Perl modules, etc.
+#
+#>  set_fwdir
+#
+#     An additional location for framework data to be added to
+#     FW_SEARCH_PATH; may be specified multiple times.
+#
+#>  set_wpdir
+#
+#     An additional location for wirecell data to be added to
+#     WIRECELL_PATH; may be specified multiple times.
+#
+#>  testdir		product_dir	test
+#
+#     Tests.
+#
+#>  wpdir
+#
+#     Wirecell data.
+#
+####################################
+fwdir	product_dir	config_data
+####################################
 
-product                 version
-cetbuildtools	        v8_20_00	-	only_for_build
-duneopdet               v09_81_00d00
-dunecalib               v09_81_00d00
-dunesim                 v09_81_00d00
+####################################
+# Product table.
+#
+# Table defining *all* direct UPS package dependencies.
+#
+##################
+# Format:
+#
+#>  product		version		qual	["<table_format=#>"]
+#>  <ups-product_name>	<ups-version>	[<qual-trigger>]	[<flag>]
+#>...
+#>  end_product_list
+#
+# <ups-version> may be a UPS version, a chain option (-c, -t, etc.) or a
+# chain name with a preceding `-'.
+#
+# Valid <qual-trigger> values:
+#
+# * [!]<single-qual>
+#
+#   A single qualifier whose presence in the parent's qualifier will
+#   trigger the setup of the specified version of the product. A prefix
+#   of `!' will negate the match.
+#
+# * <empty>|-
+#
+#   The specified version of the product will always be set up
+#   regardless of the parent's qualifiers. Use `-' as a placeholder if
+#   <flag> is to be specified.
+#
+# * -nq-
+#
+#   Specify explicitly that this product should be set up when the
+#   parent is unqualified.
+#
+# * -default-
+#
+#   The specified version of the product will be set up if no other
+#   product table entry for this product is applicable to the parent's
+#   qualifiers.
+#
+# Valid <flag> values:
+#
+# * only_for_build
+#
+#   The specified product will be set up for building only, and will not
+#   be added to the table file.
+#
+# * optional
+#
+#   It will not be an error if the specified product is not available to
+#   be set up.
+#
+##################
+# Notes.
+#
+# * Under older versions of the product table format ("<table_format=1>"
+#   or unspecified), -nq- had the same meaning as `-' above. When
+#   updating a product_deps file these entries should be reviewed when
+#   <table_format=2> is selected.
+#
+# * "<format>" is a valid alias for "<table_format>".
+#
+# * Under most circumstances (the parent is anything other than
+#   cetmodules), an entry for cetmodules is required.
+#
+# * It is an error for more than one non-(<qual-trigger> == "-default-")
+#   entry to match for a given product.
+#
+####################################
+product		version		qual	flags		<table_format=2>
+dunecalib	v09_81_00d00	-
+duneopdet	v09_81_00d00	-
+dunesim		v09_81_00d00	-
+cetmodules	v3_22_02	-	only_for_build
 end_product_list
+####################################
 
-# We now define allowed qualifiers and the corresponding qualifiers for the depdencies.
-# Make a table by adding columns before "notes".
-qualifier      duneopdet  dunecalib   dunesim         notes
-c14:debug      c14:debug  c14:debug   c14:debug     
-c14:prof       c14:prof   c14:prof    c14:prof      
-e26:debug      e26:debug  e26:debug   e26:debug    
-e26:prof       e26:prof   e26:prof    e26:prof     
+####################################
+# Qualifier table.
+#
+# For each valid qualifer set of the parent, specify how dependencies
+# should be set up.
+#
+# Format:
+#
+#>  qualifier		<prod-spec>...	[<notes>]
+#>  <parent-qual>	<spec>...   [<text...>]
+#>...
+#>  end_qualifier_list
+#
+# <prod-spec> may be a product name or "compiler."
+#
+# <parent-qual> may be a colon-delimited qualifier set, or "-nq-" as a
+# column placeholder in the case of no parent qualifiers.
+#
+# Unless <prod-spec> is "compiler", <spec> may be a colon-delimited
+# qualifier set, or:
+#
+# * -
+#
+#   The dependency is not required for this <parent-qual> and will not
+#   be set up.
+#
+# * -nq-
+#
+#   The dependency will be set up without qualifiers.
+#
+# * -b- (deprecated)
+#
+#   A build-only dependency for this <parent-qual>. If the dependency is
+#   set up in this way, it will be set up without qualifiers. For more
+#   flexibility, use the product table to specify the only_for_build
+#   nature of the dependency and the qualifier table to specifiy how it
+#   should be set up.
+#
+# If <prod-spec> is "compiler", <spec> must be `-' (no compiler
+# required) or the name of the UPS product for the desired compiler. Any
+# qualifiers required to set up the compiler should be specified in the
+# appropriate column for that product.
+#
+##################
+# Notes.
+#
+# * A column for every product in the product table (see above) is
+#   *required* unless the only_for_build flag is specified, in which
+#   case it is optional.
+#
+####################################
+qualifier	duneopdet	dunecalib	dunesim		notes
+c14:debug	c14:debug	c14:debug	c14:debug
+c14:prof	c14:prof	c14:prof	c14:prof
+e26:debug	e26:debug	e26:debug	e26:debug
+e26:prof	e26:prof	e26:prof	e26:prof
 end_qualifier_list
+####################################
+
+####################################
+# Table fragment.
+#
+####################################
+####################################
+
+####################################
+# Backmatter.
+#
+# Comments and editor-specific metadata.
 
 # Preserve tabs and formatting in emacs and vi / vim:
 
 ### Local Variables:
+### mode: sh
 ### tab-width: 8
 ### End:
+
+# vi:set ts=8 noexpandtab:
diff --git a/ups/setup_deps b/ups/setup_deps
deleted file mode 100644
index 72c2e32..0000000
--- a/ups/setup_deps
+++ /dev/null
@@ -1,89 +0,0 @@
-# NO USER-SERVICEABLE PARTS BELOW.
-#
-# There should be as little as possible here,
-# with most of the heavy lifting done by other small scripts
-#
-# When sourcing this file from a script, you may have to tell this
-# source file where it is via the fw_db shell (or env) variable.
-# I.e.:
-#    set fw_db=/some/path; source /some/path/this_file
-# or  fw_db=/some/path; . /some/path/this_file
-
-test $?shell = 1 && set ss=csh || ss=sh
-#echo Shell type is $ss.
-
-# make some things similar. need to use set_ because sh builtin set would hide function set
-# Note: perhaps the trickiest thing in this file is the sh set_ function tries to return the same status
-#       as at the start of the function (which most likely is the result of a back-tick expression
-test "$ss" = csh && alias set_ set && alias vecho_ 'if ($?vv == 1) echo \!*' || eval 'vecho_() { test -n "${vv-}" && echo "$@"; return 0; }'
-test "$ss" =  sh && eval 'set_() { sts=$?;for xx in "$@";do var=`expr "$xx" : "\([^=]*\)"`;val=`expr "$xx" : "[^=]*=\(.*\)"`;eval "$var=\"$val\"";done;return $sts; }'
-test "$ss" =  sh && eval 'setenv() { export $1;eval "$1=\"\${2-}\""; }; source() { file=$1; shift; . $file "$@"; }; unsetenv_() { unset "$@"; }'
-test "$ss" =  sh && eval 'tnotnull() { eval "test -n \"\${$1-}\""; }'                             && eval 'nullout() { "$@" >/dev/null 2>&1; }'
-test "$ss" = csh && alias tnotnull "eval '"'test $?'"\!* -eq 1' && eval '"'test -n "$'"\!*"'"'"'" && alias nullout "\!* >& /dev/null" && alias unsetenv_ unsetenv
-test "$ss" = csh && alias return exit
-
-set_ msg1='ERROR: You MUST setup ups'
-test -z $UPS_DIR && ( echo ""; echo "$msg1"; echo "" ) && return
-
-set_ msg3='ERROR: You MUST specify either -o, -p, or -d'
-set_ msg4='Usage: setup_deps <-d|-o|-p> <qualifier list>'
-test -z "$1" && ( echo ""; echo "$msg4"; echo "$msg3"; echo "" ) && return
-
-# make sure we know where this script lives
-# now if we were passed a path or if not, we can figure it out (maybe if we are interactive)
-#   bash, zsh, ksh and tcsh pass params to a source file, csh does not. but someone will be writing csh scripts
-set_ msg2='Please set shell or env. variable fw_db (to be the path to the framework source code). Fix this and other errors may go away.'
-tnotnull fw_db && set_ db=`sh -c "cd $fw_db >/dev/null 2>&1 && pwd"` && vecho_ 'setting db from fw_db variable' || set_ db=
-
-test -z "$db" && tnotnull BASH_SOURCE && set_ me=`dirname $BASH_SOURCE` && set_ db=`sh -c "cd $me >/dev/null 2>&1 && pwd"` && vecho_ 'setting db via BASH_SOURCE'
-
-# history is applicable only for interactive t/csh
-test -z "$db" -a "$ss" = csh && test $?history = 0 && set history=5  # make sure history 1 works
-test -z "$db" -a "$ss" = csh && set me=`history 1|sed 's/^[ 	0-9:]*//'` && test -n "$me" && set me=`dirname $me[2]` \
-    && set db=`sh -c "cd $me >/dev/null 2>&1 && pwd"` && vecho_ 'setting db via interactive history'
-#echo This script lives in $db
-
-test -z "$db" && echo "$msg2" || vecho_ "db=$db"
-test -n "$db" && setenv CETPKG_SOURCE `dirname $db`
-
-# make sure we know the current directory
-set_ myname=`whoami`
-setenv CETPKG_BUILD /tmp/$myname/setup_deps
-rm -rf $CETPKG_BUILD
-mkdir -p $CETPKG_BUILD
-#echo Build directory is $CETPKG_BUILD
-
-echo The source code directory is $CETPKG_SOURCE
-
-set_ msg5='ERROR: setup of required products has failed'
-
-echo ----------- check this block for errors -----------------------
-set_ setup_fail="false"
-set_ exit_now="false"
-set_ cetb=` grep -e '^[ \t]*cetbuildtools' $CETPKG_SOURCE/ups/product_deps | grep  only_for_build| awk '{ print $1 }' `
-set_ cetv=` grep -e '^[ \t]*cetbuildtools' $CETPKG_SOURCE/ups/product_deps | grep  only_for_build| awk '{ print $2 }' `
-#echo Found $cetb $cetv
-setup -B $cetb $cetv
-test "$?" = 0 || set_ setup_fail="true"
-# now get the rest of the products
-set_ cmd="$CETBUILDTOOLS_DIR/bin/set_dev_products $CETPKG_SOURCE $CETPKG_BUILD $*"
-#echo Ready to run $cmd
-source `$cmd`
-test "$?" = 0 || set_ setup_fail="true"
-#echo "$cmd returned $setup_fail"
-test "$setup_fail" = "true" && echo "$msg5"
-test "$setup_fail" = "true" && set_ exit_now="true"
-test -e "$CETPKG_BUILD/diag_report" && cat $CETPKG_BUILD/diag_report
-echo ----------------------------------------------------------------
-
-test "${exit_now}" = "true" && test "$ss" = csh && unalias tnotnull nullout set_ vecho_ return
-test "${exit_now}" = "true" && unset ss db me thisdir msg1 msg2 msg3 msg4 msg5 setup_fail set_ setenv unsetenv_ tnotnull nullout vecho_
-test "${exit_now}" = "true" && return 1
-
-# final sanity check and report
-source $CETBUILDTOOLS_DIR/bin/set_dep_check_report
-
-# cleanup before exiting
-test "$ss" = csh && unalias tnotnull nullout set_ vecho_ return
-unset ss db me thisdir msg1 msg2 msg3 msg4 msg5 setup_fail
-unset set_ setenv unsetenv_ tnotnull nullout vecho_
diff --git a/ups/setup_for_development b/ups/setup_for_development
index 8c5bedf..e46765f 100644
--- a/ups/setup_for_development
+++ b/ups/setup_for_development
@@ -1,96 +1,260 @@
-# NO USER-SERVICEABLE PARTS BELOW.
+########################################################################
+# This script is shell-agnostic, which involves much acrobatics to avoid
+# causing errors in one interpreter or another (*stares in csh*).
 #
-# There should be as little as possible here,
-# with most of the heavy lifting done by other small scripts
+# There should be as little as possible here, with most of the heavy
+# lifting done by other small scripts.
 #
 # When sourcing this file from a script, you may have to tell this
-# source file where it is via the fw_db shell (or env) variable.
-# I.e.:
+# source file where it is via the fw_db shell (or env) variable, i.e.
 #    set fw_db=/some/path; source /some/path/this_file
 # or  fw_db=/some/path; . /some/path/this_file
+#
+# Generated by cetmodules 3.22.02 at Wed Sep 13 16:53:29 CDT 2023
+########################################################################
+
+########################################################################
+# NO USER-SERVICEABLE PARTS BELOW.
+########################################################################
+
+# Determine shell flavor.
+true && test $?shell = 1 && set _cetpkg_shell_flavor=csh || _cetpkg_shell_flavor=sh
+
+####################################
+# A common set of commands to use to hide as many shell flavor
+# differences as possible.
+
+##################
+# IMPORTANT NOTE:
+#
+# Following extensive tests in multiple shells, I have reached the
+# conclusion that it is not actually possible for a function to mirror
+# the semantics of an assignment with respect to the status code of ``
+# and compound statements joined with "||" or "&&". To handle this, we
+# write a large chunk of shell code to a temporary file in the current
+# directory a.k.a. CETPKG_BUILD with shell variable assignments correct
+# according to the shell flavor, and then source it. This also allows us
+# to deal with the fact that some shells don't pass arguments to sourced
+# scripts *stares harder in csh*.
+#
+# 2020-06-24 CHG.
+##################
+
+# If we're C-flavored, set up the commands using alias.
+test "$_cetpkg_shell_flavor" = csh && \
+  set _cetpkg_nobuild="" && \
+  set _cetpkg_shell_var_set=set\\1 && \
+  set _cetpkg_to_stderr="| sh -c 'cat 1>\\&2'" && \
+  alias vecho_ 'if ($?vv == 1) echo \>\> \!*' && \
+  alias unsetenv_ unsetenv && \
+  alias tnotnull "eval '"'test $?'"\!* -eq 1' && eval '"'test -n "$'"\!*"'"'"'" && \
+  alias nullout "\!* >& /dev/null" && \
+  alias __TOP_EOF__ '' && \
+  alias return exit
+
+# For Bourne-flavored shells, use functions.
+test "$_cetpkg_shell_flavor" = sh && \
+  _cetpkg_nobuild="" && \
+  _cetpkg_shell_var_set= && \
+  _cetpkg_to_stderr='1>\&2' && \
+  eval 'vecho_() { test -n "${vv-}" && echo ">> $*"; return 0; }' && \
+  eval 'setenv() { eval "$1=\"\${2-}\"; export $1"; }' && \
+  eval 'unsetenv_() { unset "$@"; }' && \
+  eval 'source() { . "$@"; }' && \
+  eval 'tnotnull() { eval "test -n \"\${$1-}\""; }' && \
+  eval 'nullout() { "$@" >/dev/null 2>&1; }'
+####################################
+
+##################
+# Check for UPS (uses alias for return in C-flavored shells).
+test -z "$UPS_DIR" && \
+  ( echo ""; echo "ERROR: you MUST set up UPS"; echo "" ) && \
+  return 1 || true
+##################
+
+####################################
+# Need to find ourselves to set CETPKG_SOURCE.
+
+# Define empty variables for C-flavor shells to make things easier.
+test "$_cetpkg_shell_flavor" = csh && \
+  set _cetpkg_fw_db= _cetpkg_myself= _cetpkg_mydir=
+
+# If user has set fw_db, identify our top-level source directory now.
+test "$_cetpkg_shell_flavor" = csh && tnotnull fw_db && \
+  set _cetpkg_fw_db=`sh -c "cd $fw_db:q >/dev/null 2>&1 && /bin/pwd -P"` && \
+  vecho_ "found ourselves through fw_db" || true
+test "$_cetpkg_shell_flavor" = sh && tnotnull fw_db && \
+  _cetpkg_fw_db=`sh -c "cd \"$fw_db\" >/dev/null 2>&1 && /bin/pwd -P"` && \
+  vecho_ "found ourselves through fw_db" || true
+
+##################
+# For Bash and zsh, identify ourselves now so we don't have to go
+# through acrobatics later in the sourced script.
+test "$_cetpkg_shell_flavor" = sh && tnotnull BASH_SOURCE && \
+  _cetpkg_myself="$BASH_SOURCE" && test -n "$BASH_SOURCE" && \
+  vecho_ "found ourselves through BASH_SOURCE" || true
+test "$_cetpkg_shell_flavor" = sh -a -z "$_cetpkg_myself" && \
+  tnotnull ZSH_VERSION && eval '_cetpkg_myself="${(%):-%x}"' && \
+  test -n "$_cetpkg_myself" && \
+  vecho_ "found ourselves through ZSH prompt logic" || true
+test "$_cetpkg_shell_flavor" = sh && tnotnull _cetpkg_myself && \
+  _cetpkg_mydir=`dirname "$_cetpkg_myself"` && \
+  _cetpkg_fw_db=`sh -c "cd $_cetpkg_mydir >/dev/null 2>&1 && /bin/pwd -P"` || true
+##################
+
+##################
+# History is applicable only for interactive t/csh.
+test -z "$_cetpkg_fw_db" -a "$_cetpkg_shell_flavor" = csh -a $?history = 0 && \
+  set history=5  || true
+test -z "$_cetpkg_fw_db" -a "$_cetpkg_shell_flavor" = csh && \
+  set _cetpkg_mydir=`history 1|sed -Ee 's/^[[:space:][:digit:]:]*.*\bsource[[:space:]]+//'` && \
+  test -n "$_cetpkg_mydir" && set _cetpkg_mydir=`dirname $_cetpkg_mydir[1]:q` && \
+  set _cetpkg_fw_db=`sh -c "cd $_cetpkg_mydir:q >/dev/null 2>&1 && /bin/pwd -P"` && \
+  vecho_ 'setting db via interactive history' || true
+##################
+
+# Set CETPKG_SOURCE.
+test -n "$_cetpkg_fw_db" && \
+  vecho_ "_cetpkg_fw_db=$_cetpkg_fw_db" && \
+  setenv CETPKG_SOURCE `dirname $_cetpkg_fw_db` || \
+  printf "WARNING: please set shell or env. variable fw_db (to be the path to the\n\
+         framework source code). Fix this and other errors may go away.\n"
+####################################
+
+##################
+# Set CETPKG_BUILD.
+setenv CETPKG_BUILD `/bin/pwd -P`
+##################
+
+########################################################################
+# Write the rest of ourselves to a file and source it to handle status
+# code semantics for variable assignments.
+#
+# Note that even here we have to play a trick or two due to the fact
+# that we have to deal with the difference in the way sh- and csh-flavor
+# shells handle a quoted delimiter word for a HERE document: the latter
+# expect the delimiter to include the quoting; the former do not. This
+# is the reason for the C-flavored __TOP_EOF__ alias, and the explicit
+# return at the end of the sourced script.
+#
+########################################################################
+
+sed -Ee 's&(^|[^[:alnum:]_])__SET__([[:space:]]+)&'$_cetpkg_shell_var_set'&g' \
+  -e 's&__SETUP_ARGS__&'"$*"'&g' \
+  -e 's&__TO_STDERR__&'"$_cetpkg_to_stderr"'&g' \
+  > ./setup_common.$_cetpkg_shell_flavor <<\__TOP_EOF__
+########################################################################
+
+####################################
+# Personality check: are we setup_deps or setup_for_development?
+#
+# If we're sourcing setup.in directly (e.g. for cetmodules itself) then
+# we select "setup_for_development" behavior, otherwise _cetpkg_nobuild
+# will be set appropriately by CMake's CONFIGURE() command for
+# setup_for_development or setup_deps.
+
+test -z "$_cetpkg_nobuild" -o "$_cetpkg_nobuild" = "--nobuild" || \
+  __SET__ _cetpkg_nobuild="" || true
+####################################
+
+####################################
+# Initial info.
+
+printf "\n";
+test -z "$_cetpkg_nobuild" && \
+  echo "The working build directory is $CETPKG_BUILD" || true
+cat <<EOF
+The source code directory is $CETPKG_SOURCE
+
+---------------------- check this block for errors ---------------------
+EOF
+
+__SET__ _cetpkg_status=""
+####################################
+
+####################################
+# Attempt to find a suitable cetmodules to set up.
+
+__SET__ _cetpkg_cetmsetup=`sed -nE 's&^[[:space:]]*(cetmodules)[[:space:]]+([^[:space:]]+).*\bonly_for_build\b.*$&\1 \2&p' "$CETPKG_SOURCE/ups/product_deps"`
+test -z "_cetpkg_cetmsetup" -a ! -x "$CETPKG_SOURCE/libexec/set_dev_products" && \
+  __SET__ _cetpkg_status=1 && \
+  echo "ERROR: unable to find suitable cetmodules >= 2.00.00" || true
+test -n "$_cetpkg_status" -o -z "$_cetpkg_cetmsetup" || setup -B $_cetpkg_cetmsetup
+test $? != 0 && __SET__ _cetpkg_status=1 && \
+  echo "ERROR: setup of $_cetpkg_cetmsetup has failed" || true
+test -z "$_cetpkg_status$_cetpkg_cetmsetup" && setenv PATH `dropit -sfe "$CETPKG_SOURCE/bin"` && __SET__ _cetpkg_cettop="$CETPKG_SOURCE" || true
+test -z "$_cetpkg_status$_cetpkg_cettop" -a -n "$CETMODULES_DIR" && __SET__ _cetpkg_cettop="$CETMODULES_DIR"
+####################################
+
+########################################################################
+# A bootstrapped Perl environment is only needed if we're building
+# cetmodules itself.
+
+test -n "$_cetpkg_status" || test -n "$CETMODULES_DIR" || \
+  setup cetpkgsupport
+test $? != 0 && __SET__ _cetpkg_status=1 && \
+  echo "ERROR: setup of cetpkgsupport has failed" || true
+test -n "$_cetpkg_status" || test -n "$CETMODULES_DIR" || \
+  yes n | "$_cetpkg_cettop/libexec/bootstrap-perl-env" > \
+  "$CETPKG_BUILD/bootstrap.log"
+test $? != 0 && __SET__ _cetpkg_status=1 && \
+  echo "ERROR: bootstrap of Perl environment for cetmodules has failed: see $CETPKG_BUILD/bootstrap.log" || true
+test -n "$_cetpkg_status" || test -n "$CETMODULES_DIR" || \
+  eval "`perl -I\"$CETPKG_BUILD/$CET_SUBDIR/CPAN/lib/perl5\" -Mlocal::lib=\"$CETPKG_BUILD/$CET_SUBDIR/CPAN\",\"$CETPKG_BUILD/$CET_SUBDIR/cpan_build\"\`test \$?shell = 1 && printf \",--shelltype=csh\"\``"
+test $? != 0 && __SET__ _cetpkg_status=1 && \
+  echo "ERROR: setup of Perl environment for cetmodules has failed" || true
+
+####################################
+# Generate the setup script to set up dependencies.
+
+test -n "$_cetpkg_status" || \
+  __SET__ _cetpkg_setup="`${_cetpkg_cettop}/libexec/set_dev_products $_cetpkg_nobuild __SETUP_ARGS__`"
+test $? != 0 -o -z "$_cetpkg_setup" && __SET__ _cetpkg_status=1 && \
+  echo "ERROR: generation of setup script has failed" || true
+####################################
+
+####################################
+# Source the setup script to set up dependencies.
+
+test -n "$_cetpkg_status" || source "$_cetpkg_setup"
+test $? != 0 && __SET__ _cetpkg_status=1 && \
+  echo "ERROR: setup of required products has failed" || true
+__SET__ _cetpkg_setup_errlog="$CETPKG_BUILD/cetpkg_setup.err"
+test -s "$_cetpkg_setup_errlog" && cat "$_cetpkg_setup_errlog" || \
+  rm -f "$_cetpkg_setup_errlog"
+####################################
+
+cat <<EOF
+------------------------------------------------------------------------
+
+EOF
+
+# Final sanity check and report.
+test -n "$_cetpkg_status" -o -n "$_cetpkg_nobuild" || \
+  "$_cetpkg_cettop/libexec/verify_build_environment" "$CETPKG_BUILD"
+test $? != 0 && __SET__ _cetpkg_status=1 && \
+  echo "ERROR: unable to verify build environment" || true
+
+####################################
+# Clean up before exiting.
+
+# Clean up C-flavor aliases and prepare to return^H^H^H^H^H^Hexit.
+test "$_cetpkg_shell_flavor" = csh && \
+  unalias vecho_ unsetenv_ tnotnull nullout __TOP_EOF__ return && \
+  set return=exit || return=return
+
+# Finish cleanup and exit. Note the use of eval so we can unset
+# everything including $return and $_cetpkg_status.
+eval "unset vecho_ setenv unsetenv_ source tnotnull nullout "\
+"_cetpkg_nobuild _cetpkg_shell_var_set _cetpkg_to_stderr"\
+"_cetpkg_fw_db _cetpkg_myself _cetpkg_mydir _cetpkg_cetmsetup "\
+"_cetpkg_cettop _cetpkg_setup _cetpkg_setup_errlog "\
+"_cetpkg_shell_flavor return _cetpkg_status; \
+$return $_cetpkg_status"
+####################################
+
+########################################################################
+\__TOP_EOF__
+__TOP_EOF__
 
-test $?shell = 1 && set ss=csh || ss=sh
-#echo Shell type is $ss.
-
-# make some things similar. need to use set_ because sh builtin set would hide function set
-# Note: perhaps the trickiest thing in this file is the sh set_ function tries to return the same status
-#       as at the start of the function (which most likely is the result of a back-tick expression
-test "$ss" = csh && alias set_ set && alias vecho_ 'if ($?vv == 1) echo \!*' || eval 'vecho_() { test -n "${vv-}" && echo "$@"; return 0; }'
-test "$ss" =  sh && eval 'set_() { sts=$?;for xx in "$@";do var=`expr "$xx" : "\([^=]*\)"`;val=`expr "$xx" : "[^=]*=\(.*\)"`;eval "$var=\"$val\"";done;return $sts; }'
-test "$ss" =  sh && eval 'setenv() { export $1;eval "$1=\"\${2-}\""; }; source() { file=$1; shift; . $file "$@"; }; unsetenv_() { unset "$@"; }'
-test "$ss" =  sh && eval 'tnotnull() { eval "test -n \"\${$1-}\""; }'                             && eval 'nullout() { "$@" >/dev/null 2>&1; }'
-test "$ss" = csh && alias tnotnull "eval '"'test $?'"\!* -eq 1' && eval '"'test -n "$'"\!*"'"'"'" && alias nullout "\!* >& /dev/null" && alias unsetenv_ unsetenv
-test "$ss" = csh && alias return exit
-
-set_ msg1='ERROR: You MUST setup ups'
-test -z $UPS_DIR && ( echo ""; echo "$msg1"; echo "" ) && return
-
-set_ msg3='ERROR: You MUST specify either -o, -p, or -d'
-set_ msg4='Usage: setup_for_development <-d|-o|-p> <qualifier list>'
-test -z "$1" && ( echo ""; echo "$msg4"; echo "$msg3"; echo "" ) && return
-
-# make sure we know where this script lives
-# now if we were passed a path or if not, we can figure it out (maybe if we are interactive)
-#   bash, zsh, ksh and tcsh pass params to a source file, csh does not. but someone will be writing csh scripts
-set_ msg2='Please set shell or env. variable fw_db (to be the path to the framework source code). Fix this and other errors may go away.'
-tnotnull fw_db && set_ db=`sh -c "cd $fw_db >/dev/null 2>&1 && pwd"` && vecho_ 'setting db from fw_db variable' || set_ db=
-
-test -z "$db" && tnotnull BASH_SOURCE && set_ me=`dirname $BASH_SOURCE` && set_ db=`sh -c "cd $me >/dev/null 2>&1 && pwd"` && vecho_ 'setting db via BASH_SOURCE'
-
-# history is applicable only for interactive t/csh
-test -z "$db" -a "$ss" = csh && test $?history = 0 && set history=5  # make sure history 1 works
-test -z "$db" -a "$ss" = csh && set me=`history 1|sed 's/^[ 	0-9:]*//'` && test -n "$me" && set me=`dirname $me[2]` \
-    && set db=`sh -c "cd $me >/dev/null 2>&1 && pwd"` && vecho_ 'setting db via interactive history'
-#echo This script lives in $db
-
-test -z "$db" && echo "$msg2" || vecho_ "db=$db"
-test -n "$db" && setenv CETPKG_SOURCE `dirname $db`
-
-# make sure we know the current directory
-setenv CETPKG_BUILD `pwd`
-#echo Build directory is $CETPKG_BUILD
-
-echo The working build directory is $CETPKG_BUILD
-echo The source code directory is $CETPKG_SOURCE
-
-set_ msg5='ERROR: setup of required products has failed'
-
-echo ----------- check this block for errors -----------------------
-set_ setup_fail="false"
-set_ exit_now="false"
-set_ cetb=` grep -e '^[ \t]*cetbuildtools' $CETPKG_SOURCE/ups/product_deps | grep  only_for_build| awk '{ print $1 }' `
-set_ cetv=` grep -e '^[ \t]*cetbuildtools' $CETPKG_SOURCE/ups/product_deps | grep  only_for_build| awk '{ print $2 }' `
-#echo Found $cetb $cetv
-setup -B $cetb $cetv
-test "$?" = 0 || set_ setup_fail="true"
-# now get the rest of the products
-set_ cmd="$CETBUILDTOOLS_DIR/bin/set_dev_products $CETPKG_SOURCE $CETPKG_BUILD $*"
-#echo Ready to run $cmd
-source `$cmd`
-test "$?" = 0 || set_ setup_fail="true"
-#echo "$cmd returned $setup_fail"
-test "$setup_fail" = "true" && echo "$msg5"
-test "$setup_fail" = "true" && set_ exit_now="true"
-test -e "$CETPKG_BUILD/diag_report" && cat $CETPKG_BUILD/diag_report
-echo ----------------------------------------------------------------
-
-test "${exit_now}" = "true" && test "$ss" = csh && unalias tnotnull nullout set_ vecho_ return
-test "${exit_now}" = "true" && unset ss db me thisdir msg1 msg2 msg3 msg4 msg5 setup_fail set_ setenv unsetenv_ tnotnull nullout vecho_
-test "${exit_now}" = "true" && return 1
-
-# add lib to LD_LIBRARY_PATH
-source $CETBUILDTOOLS_DIR/bin/set_dev_lib
-# add bin to path
-source $CETBUILDTOOLS_DIR/bin/set_dev_bin
-# set FHICL_FILE_PATH
-source $CETBUILDTOOLS_DIR/bin/set_dev_fhicl
-# set FW_SEARCH_PATH
-source $CETBUILDTOOLS_DIR/bin/set_dev_fwsearch
-
-# final sanity check and report
-source $CETBUILDTOOLS_DIR/bin/set_dev_check_report
-
-# cleanup before exiting
-test "$ss" = csh && unalias tnotnull nullout set_ vecho_ return
-unset ss db me thisdir msg1 msg2 msg3 msg4 msg5 setup_fail
-unset set_ setenv unsetenv_ tnotnull nullout vecho_
+source ./setup_common.$_cetpkg_shell_flavor
